<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Aaron Shavitz">

<title>Midterm Exam</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="midterm_files/libs/clipboard/clipboard.min.js"></script>
<script src="midterm_files/libs/quarto-html/quarto.js"></script>
<script src="midterm_files/libs/quarto-html/popper.min.js"></script>
<script src="midterm_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="midterm_files/libs/quarto-html/anchor.min.js"></script>
<link href="midterm_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="midterm_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="midterm_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="midterm_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="midterm_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Midterm Exam</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Aaron Shavitz </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<p>github: https://github.com/ashavitz/BIOL_607_homework/tree/main</p>
<section id="midterm-exam" class="level1">
<h1>Midterm Exam!</h1>
<section id="load-libraries" class="level3">
<h3 class="anchored" data-anchor-id="load-libraries">Load Libraries</h3>
<p>All libraries used in the Midterm are loaded here:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Data management</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualization</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggthemes)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Modeling and related</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom.mixed)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DHARMa)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(emmeans)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(glmmTMB)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4)</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(performance)</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(modelr)</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(modelbased)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="set-ggplot-theme" class="level3">
<h3 class="anchored" data-anchor-id="set-ggplot-theme">Set ggplot theme</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Setting a standard ggplot theme for plotting</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_clean</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="data-reshaping-and-visuzliation" class="level2">
<h2 class="anchored" data-anchor-id="data-reshaping-and-visuzliation">1. Data Reshaping and Visuzliation</h2>
<p><strong>Johns Hopkins has been maintaining one of the best Covid-19 timseries data sets out there. The data on the US can be found here with information about what is in the data at https://github.com/CSSEGISandData/COVID-19/tree/master/csse_covid_19_data</strong></p>
<section id="a.-access" class="level3">
<h3 class="anchored" data-anchor-id="a.-access">1a. Access</h3>
<p><strong>Download and read in the data. Can you do this without downloading, but read directly from the archive?</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>covid_us <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"https://raw.githubusercontent.com/CSSEGISandData/COVID-19/refs/heads/master/csse_covid_19_data/csse_covid_19_time_series/time_series_covid19_confirmed_US.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 3342 Columns: 1154
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr    (6): iso2, iso3, Admin2, Province_State, Country_Region, Combined_Key
dbl (1148): UID, code3, FIPS, Lat, Long_, 1/22/20, 1/23/20, 1/24/20, 1/25/20...

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
</div>
</section>
<section id="b.-its-big-and-wide" class="level3">
<h3 class="anchored" data-anchor-id="b.-its-big-and-wide">1b. It’s big and wide!</h3>
<p><strong>The data is, well, huge. It’s also wide, with dates as columns. Write a workflow that will filter to a state (your choice which one!), and then return a time series (long data where every row is a day) with columns for date, new daily cases and for cumulative cases in that state.</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter to include only Vermont</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>covid_vt <span class="ot">&lt;-</span> <span class="fu">filter</span>(covid_us, Province_State <span class="sc">==</span> <span class="st">"Vermont"</span>) <span class="sc">|&gt;</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Move state name to first column</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(Province_State, Admin2, <span class="at">.before =</span> UID) <span class="sc">|&gt;</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Remove excess variables</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(UID<span class="sc">:</span>Combined_Key)) <span class="sc">|&gt;</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Pivot longer to make each row a unique day. Columns for date and cumulative cases</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span><span class="fu">c</span>(Province_State, Admin2),</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"date_col"</span>,</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"cumulative_cases"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Convert date_col to Date format</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">date_col =</span> lubridate<span class="sc">::</span><span class="fu">mdy</span>(date_col)) <span class="sc">|&gt;</span> </span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Group by date to sum values across Admin2 (get whole state values per day)</span></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(date_col) <span class="sc">|&gt;</span></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">cumulative_cases =</span> <span class="fu">sum</span>(cumulative_cases)) <span class="sc">|&gt;</span> </span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate new_daily_cases based on cumulative data</span></span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">new_daily_cases =</span> <span class="fu">c</span>(cumulative_cases[<span class="dv">1</span>], <span class="fu">diff</span>(cumulative_cases)))</span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Note - I read about diff() here:</span></span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a><span class="co"># https://www.rdocumentation.org/packages/base/versions/3.6.2/topics/diff </span></span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a><span class="co"># and used cumulative_cases[1] as the first value, as the first new value would be the same</span></span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a><span class="co"># as the first cumulative value</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Note, let’s make the date column that emerges a true date object. Let’s say you’ve called it date_col.&nbsp;If you mutate it, <code>mutate(date_col = lubridate::mdy(date_col))</code>, it will be turned into a date object that will have a recognized order. {lubridate} is da bomb, and I’m hoping we have some time to cover it in the future.</strong></p>
<p>(included in code chunk above)</p>
<p><strong>Even better - impress yourself (if you want - not required!) and merge it with some other data source to also return cases per 100,000 people.</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Found US Census Data for 2020 - 2024 here: </span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="co"># https://www.census.gov/data/tables/time-series/demo/popest/2020s-state-total.html</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Read in data</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="co"># census_us &lt;- read_csv("https://www2.census.gov/programs-surveys/popest/datasets/2020-2024/state/totals/NST-EST2024-ALLDATA.csv")</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="co"># # Select only relevant data and Filter data to Vermont:</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="co"># census_vt &lt;- census_us |&gt; </span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(NAME == "Vermont") |&gt; </span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(c("POPESTIMATE2020", "POPESTIMATE2021", "POPESTIMATE2022", "POPESTIMATE2023"))</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Pivot census data long by year</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Create corresponding year column in covid_vt df</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge dfs and calculate new </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="c.-lets-get-visual" class="level3">
<h3 class="anchored" data-anchor-id="c.-lets-get-visual">1c. Let’s get visual!</h3>
<p><strong>Great! Make a compelling plot of the timeseries for Massachusetts! Points for style, class, ease of understanding major trends, etc. Note, 10/10 for yourself only for the most killer figures. Don’t phone it in! Also, note what the data from JHU is. Do you want the cumulative, or daily, or what? Want to highlight features? Events? Go wild!</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Repeat data organization from above, but for MA</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>covid_ma <span class="ot">&lt;-</span> <span class="fu">filter</span>(covid_us, Province_State <span class="sc">==</span> <span class="st">"Massachusetts"</span>) <span class="sc">|&gt;</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(Province_State, Admin2, <span class="at">.before =</span> UID) <span class="sc">|&gt;</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(UID<span class="sc">:</span>Combined_Key)) <span class="sc">|&gt;</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span><span class="fu">c</span>(Province_State, Admin2),</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"date_col"</span>,</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"cumulative_cases"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">date_col =</span> lubridate<span class="sc">::</span><span class="fu">mdy</span>(date_col)) <span class="sc">|&gt;</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(date_col) <span class="sc">|&gt;</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">cumulative_cases =</span> <span class="fu">sum</span>(cumulative_cases)) <span class="sc">|&gt;</span> </span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">new_daily_cases =</span> <span class="fu">c</span>(cumulative_cases[<span class="dv">1</span>], <span class="fu">diff</span>(cumulative_cases)))</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot cumulative cases and new cases on same plot. Left y axis is new cases, right is cumulative.</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> covid_ma, </span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> date_col,</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>                     <span class="at">y =</span> cumulative_cases)) <span class="sc">+</span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_stata</span>() <span class="sc">+</span></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span>comma) <span class="sc">+</span></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Massachusetts - Cumulative Covid Cases"</span>,</span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"January 2020 - March 2023"</span>,</span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Date"</span>,</span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Cumulative Count of Covid Cases"</span>) <span class="sc">+</span></span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="dv">7</span>)</span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(</span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>    <span class="st">"text"</span>, </span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">as.Date</span>(<span class="st">"2022-02-01"</span>),</span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="dv">1250000</span>,</span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="st">"Initial Omicron Wave"</span>, </span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>, </span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">hjust =</span> <span class="fl">1.5</span>,</span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">3</span></span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(</span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">as.Date</span>(<span class="st">"2021-02-01"</span>),</span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a>        <span class="at">xend =</span> <span class="fu">as.Date</span>(<span class="st">"2022-01-01"</span>),</span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> <span class="dv">1250000</span>,</span>
<span id="cb7-41"><a href="#cb7-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">yend =</span> <span class="dv">1250000</span>),</span>
<span id="cb7-42"><a href="#cb7-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">type =</span> <span class="st">"closed"</span>, <span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.2</span>, <span class="st">"inches"</span>)),</span>
<span id="cb7-43"><a href="#cb7-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">1</span></span>
<span id="cb7-44"><a href="#cb7-44" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
ℹ Please use `linewidth` instead.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in geom_segment(aes(x = as.Date("2021-02-01"), xend = as.Date("2022-01-01"), : All aesthetics have length 1, but the data has 1143 rows.
ℹ Please consider using `annotate()` or provide this layer with data containing
  a single row.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="midterm_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># For labeling, got help from: https://r-graph-gallery.com/233-add-annotations-on-ggplot2-chart.html</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Identified Omicrom wave from: https://publichealth.jhu.edu/2022/covid-year-in-review</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="fit-and-evaluate-a-linear-model" class="level2">
<h2 class="anchored" data-anchor-id="fit-and-evaluate-a-linear-model">2. Fit and Evaluate a Linear model</h2>
<p><strong>Let’s fit and evaluate a linear model! To motivate this, we’ll look at Burness et al.’s 2012 study “Post-hatch heat warms adult beaks: irreversible physiological plasticity in Japanese quail http://rspb.royalsocietypublishing.org/content/280/1767/20131436.short the data for which they have made available at Data Dryad at http://datadryad.org/resource/doi:10.5061/dryad.gs661. We’ll be doing a slightly modified version of their analysis.</strong></p>
</section>
<section id="a.-what-should-i-do" class="level2">
<h2 class="anchored" data-anchor-id="a.-what-should-i-do">2a. What should I do?</h2>
<p><strong>Starting with loading this (new to you) data set for the very first time, what are the steps that you would take to analyze this data? Write them out! Maybe even in comments!</strong></p>
<p>I plan to:</p>
<ol type="1">
<li>Load in the data</li>
<li>Examine the data by looking at the structure and View()ing the data (I generally do these in my R Environment rather than by typing out str() or View()). I may also look at summary information</li>
<li>Identify variables of interest and create initial simple visualizations (plots)</li>
<li>Since it says we’re fitting a linear model, I would then make this model with my variables of interest and <strong>check its assumptions</strong></li>
<li>If assumptions look good, I will start to examine what the model is telling us, and if there seem to be takeaways from it. If the model fails assumptions, I would reconsider how I might need to modify the model.</li>
<li>Once I have evaluated my model, I will visualize it with plots to convery useful information from the model.</li>
</ol>
</section>
<section id="b.-lets-get-started" class="level2">
<h2 class="anchored" data-anchor-id="b.-lets-get-started">2b. Let’s get started</h2>
<p><strong>Load the data. Look at it. Anything interesting? Anything you’d want to watch out for? Or is it OK? Anything you’d change to make working with the data easier? Also, manipulate it a bit - for our analysis, we’re going to want Bird # and the Age of the birds to be categorical variables. Make sure we have variables that will work!</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>morph_data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/Morphology+data.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 880 Columns: 10
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (2): Sex, NOTES
dbl (8): Bird #, Age (days), Exp. Temp. (degree C), Mass (g), Tarsus (mm), C...

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># morph_data &lt;- read_csv("https://datadryad.org/downloads/file_stream/66259")</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="co"># str(morph_data)</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="co"># View(morph_data)</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="co"># unique(morph_data$`Bird #`)</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="co"># convert Bird #, Age, Temp treatment, and Sex to categorical variables (factors)</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>morph_data <span class="ot">&lt;-</span> morph_data <span class="sc">|&gt;</span> </span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Bird #</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">as.factor</span>(<span class="st">`</span><span class="at">Bird #</span><span class="st">`</span>),</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Age (days)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">as.factor</span>(<span class="st">`</span><span class="at">Age (days)</span><span class="st">`</span>),</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Exp. Temp. (degree C)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">as.factor</span>(<span class="st">`</span><span class="at">Exp. Temp. (degree C)</span><span class="st">`</span>),</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">Sex =</span> <span class="fu">as.factor</span>(Sex)</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>To watch out for:</p>
<ul>
<li>We can see there are NA observations for some variables</li>
<li>Also, I am seeing that there is data for weight and various size measurements. It is logical that these may be correlated, so we should watch out for that when making models.</li>
<li>The data is long. There are only 40 unique birds, and the measurements appear to be taken at different ages, with 20 birds in one temp treatment and 20 in another.</li>
<li>As stated, Bird # is initually numeric, but should be categorical.</li>
</ul>
</section>
<section id="c.-viz-before-fit" class="level2">
<h2 class="anchored" data-anchor-id="c.-viz-before-fit">2c. Viz before fit</h2>
<p><strong>The model we will fit is one where we want to look at how temperature treatment affects the development of tarsus length over time (age). Visualize this. Make it look good! Is there anything here that would shape how you fit a model? Do you see why we are treating age as categorical?</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot tarsus length by age, colored by temp treatment</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> morph_data,</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">Age (days)</span><span class="st">`</span>,</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">y =</span> <span class="st">`</span><span class="at">Tarsus (mm)</span><span class="st">`</span>,</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">color =</span> <span class="st">`</span><span class="at">Exp. Temp. (degree C)</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"red"</span>)) <span class="sc">+</span> </span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">reverse =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 112 rows containing missing values or values outside the scale range
(`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="midterm_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot tarsus length by temperature, colored by age</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> morph_data,</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">Exp. Temp. (degree C)</span><span class="st">`</span>,</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">y =</span> <span class="st">`</span><span class="at">Tarsus (mm)</span><span class="st">`</span>,</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">color =</span> <span class="st">`</span><span class="at">Age (days)</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>, <span class="at">height =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 112 rows containing non-finite outside the scale range
(`stat_boxplot()`).
Removed 112 rows containing missing values or values outside the scale range
(`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="midterm_files/figure-html/unnamed-chunk-8-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Is there anything here that would shape how you fit a model?</strong></p>
<p>Around day 34, the nature of the relationship between Tarsus length and age appears to change, leveling out and possibly increasing in spread.</p>
<p><strong>Do you see why we are treating age as categorical?</strong></p>
<p>I believe we are treating age as categorical because we already assume/know that age will impact tarsus length, but we want to see if the temperature treatment has an impact on tarsus length at different static ages. Thus, we are not treating age as continuous and calculating how change in age impacts tarsus length, rather we are treating age as a treatment category, to see if any age-temperature combinations have an effect on tarsus length.</p>
</section>
<section id="d.-fit-and-evaluate" class="level2">
<h2 class="anchored" data-anchor-id="d.-fit-and-evaluate">2d. Fit and evaluate</h2>
<p><strong>Fit a model where tarsus length is predicted by age, treatment, their interaction, and a ‘block’ effect, as it were, of bird #. Evaluate the fit. Make any modifications as you see necessary due to your model checks. Note, it’s not going to be perfect (I checked the original - hey, you can too - and they’re on the edge) - but our models are robust, so we’re OK.</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>tarsus_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="st">`</span><span class="at">Tarsus (mm)</span><span class="st">`</span> <span class="sc">~</span> <span class="st">`</span><span class="at">Age (days)</span><span class="st">`</span><span class="sc">*</span><span class="st">`</span><span class="at">Exp. Temp. (degree C)</span><span class="st">`</span> <span class="sc">+</span> <span class="st">`</span><span class="at">Bird #</span><span class="st">`</span>,</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> morph_data)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="co"># </span><span class="al">TODO</span><span class="co"> - PICK UP HERE</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="fu">check_model</span>(tarsus_lm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="midterm_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">check_collinearity</span>(<span class="fu">lm</span>(<span class="st">`</span><span class="at">Tarsus (mm)</span><span class="st">`</span> <span class="sc">~</span> <span class="st">`</span><span class="at">Age (days)</span><span class="st">`</span> <span class="sc">+</span> <span class="st">`</span><span class="at">Exp. Temp. (degree C)</span><span class="st">`</span> <span class="sc">+</span> <span class="st">`</span><span class="at">Bird #</span><span class="st">`</span>,</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> morph_data)) <span class="sc">|&gt;</span> <span class="fu">plot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Model matrix is rank deficient. VIFs may not be sensible.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="midterm_files/figure-html/unnamed-chunk-9-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The primary potential issue in the assumptions check is that there are high reported VIFs, suggesting possible collinearity. However, this will happen when you include interaction in your model, so I tested just collinearity for the model without interaction. We still see high VIFs for temperature and bird #, but this is caveated with “Model matrix is rank deficient. VIFs may not be sensible.” I believe this comes from the fact that there are only 2 temperature levels and bird number is repeated labelling, so these are essentially structured combinations leading to misevaluation of collinearity.<br>
Overall, I’d say the assumptions look good and no model adjustments are needed.</p>
</section>
<section id="e.-answer-the-question" class="level2">
<h2 class="anchored" data-anchor-id="e.-answer-the-question">2e. Answer the Question</h2>
<p><strong>A central question of this paper is - does temperature affect the development of tarsus length. With your fit model in hand, answer the question, however you deem fit. Make sure that, alongside any numerical answers you produce, there is at least one stunning figure for a publishable paper!</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Evaluate the model</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(tarsus_lm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 81 × 5
   term           estimate std.error statistic  p.value
   &lt;chr&gt;             &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
 1 (Intercept)      17.9       0.964    18.6   6.48e-63
 2 `Age (days)`7     0.452     0.568     0.795 4.27e- 1
 3 `Age (days)`9     2.70      0.568     4.75  2.44e- 6
 4 `Age (days)`11    4.62      0.568     8.13  1.97e-15
 5 `Age (days)`13    5.40      0.588     9.19  4.66e-19
 6 `Age (days)`15    6.58      0.588    11.2   8.09e-27
 7 `Age (days)`17    8.38      0.588    14.3   1.33e-40
 8 `Age (days)`19    9.62      0.588    16.4   4.09e-51
 9 `Age (days)`21   11.1       0.588    18.9   1.52e-64
10 `Age (days)`23   12.0       0.588    20.5   3.76e-73
# ℹ 71 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(tarsus_lm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = `Tarsus (mm)` ~ `Age (days)` * `Exp. Temp. (degree C)` + 
    `Bird #`, data = morph_data)

Residuals:
    Min      1Q  Median      3Q     Max 
-6.7801 -0.9779  0.0308  0.9476 10.6330 

Coefficients: (1 not defined because of singularities)
                                          Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)                               17.93587    0.96383  18.609  &lt; 2e-16
`Age (days)`7                              0.45200    0.56843   0.795 0.426790
`Age (days)`9                              2.70200    0.56843   4.753 2.44e-06
`Age (days)`11                             4.62250    0.56843   8.132 1.97e-15
`Age (days)`13                             5.40093    0.58784   9.188  &lt; 2e-16
`Age (days)`15                             6.57760    0.58784  11.189  &lt; 2e-16
`Age (days)`17                             8.38149    0.58784  14.258  &lt; 2e-16
`Age (days)`19                             9.62315    0.58784  16.370  &lt; 2e-16
`Age (days)`21                            11.11649    0.58784  18.911  &lt; 2e-16
`Age (days)`23                            12.03926    0.58784  20.481  &lt; 2e-16
`Age (days)`25                            13.66038    0.58784  23.238  &lt; 2e-16
`Age (days)`27                            14.98426    0.58784  25.490  &lt; 2e-16
`Age (days)`29                            15.45371    0.58784  26.289  &lt; 2e-16
`Age (days)`34                            17.36149    0.58784  29.534  &lt; 2e-16
`Age (days)`39                            17.17982    0.58784  29.225  &lt; 2e-16
`Age (days)`44                            17.13871    0.58784  29.155  &lt; 2e-16
`Age (days)`49                            16.88149    0.58784  28.718  &lt; 2e-16
`Age (days)`51                            16.08926    0.58784  27.370  &lt; 2e-16
`Age (days)`66                            17.45538    0.58784  29.694  &lt; 2e-16
`Age (days)`80                            16.54231    0.60755  27.228  &lt; 2e-16
`Age (days)`123                           18.34315    0.58784  31.204  &lt; 2e-16
`Exp. Temp. (degree C)`30                  1.08412    2.03964   0.532 0.595224
`Bird #`2                                  3.49435    0.99902   3.498 0.000499
`Bird #`3                                  0.32497    1.00262   0.324 0.745944
`Bird #`4                                  1.93196    0.99902   1.934 0.053540
`Bird #`5                                  4.48339    0.99902   4.488 8.43e-06
`Bird #`6                                  1.87482    0.99902   1.877 0.060987
`Bird #`7                                  3.07149    0.99902   3.075 0.002192
`Bird #`8                                 -0.54500    1.27105  -0.429 0.668219
`Bird #`9                                  3.42863    0.99902   3.432 0.000635
`Bird #`10                                 2.58911    0.99902   2.592 0.009754
`Bird #`11                                 2.65482    0.99902   2.657 0.008057
`Bird #`12                                -0.21613    0.99902  -0.216 0.828785
`Bird #`13                                -0.23518    0.99902  -0.235 0.813961
`Bird #`14                                 2.56196    0.99902   2.564 0.010544
`Bird #`15                                -0.61232    0.99902  -0.613 0.540130
`Bird #`16                                 4.01347    1.00262   4.003 6.93e-05
`Bird #`17                                 2.27054    0.99902   2.273 0.023348
`Bird #`18                                -0.93280    0.99902  -0.934 0.350779
`Bird #`19                                 4.28863    0.99902   4.293 2.02e-05
`Bird #`20                                 1.49577    0.99902   1.497 0.134788
`Bird #`21                                -0.12479    1.88373  -0.066 0.947199
`Bird #`22                                 2.76425    1.88373   1.467 0.142714
`Bird #`23                                 0.88521    1.88373   0.470 0.638559
`Bird #`24                                -0.19289    1.88373  -0.102 0.918471
`Bird #`25                                 0.79949    1.88373   0.424 0.671392
`Bird #`26                                 0.21997    1.88373   0.117 0.907074
`Bird #`27                                -0.42860    1.88373  -0.228 0.820079
`Bird #`28                                -0.14813    1.88373  -0.079 0.937345
`Bird #`29                                 5.13378    1.88373   2.725 0.006587
`Bird #`30                                 0.42568    1.88373   0.226 0.821285
`Bird #`31                                 0.05092    1.88373   0.027 0.978443
`Bird #`32                                 0.25759    1.88373   0.137 0.891274
`Bird #`33                                 0.28521    1.88373   0.151 0.879701
`Bird #`34                                 1.06568    1.88373   0.566 0.571762
`Bird #`35                                 1.04997    1.88373   0.557 0.577444
`Bird #`36                                -0.01908    1.88373  -0.010 0.991921
`Bird #`37                                 0.62916    2.00336   0.314 0.753577
`Bird #`38                                 1.67140    1.88373   0.887 0.375238
`Bird #`39                                 1.54521    1.88373   0.820 0.412334
`Bird #`40                                      NA         NA      NA       NA
`Age (days)`7:`Exp. Temp. (degree C)`30   -0.10726    0.81439  -0.132 0.895253
`Age (days)`9:`Exp. Temp. (degree C)`30    0.54642    0.81439   0.671 0.502475
`Age (days)`11:`Exp. Temp. (degree C)`30  -0.09566    0.81439  -0.117 0.906531
`Age (days)`13:`Exp. Temp. (degree C)`30   1.31328    0.82806   1.586 0.113203
`Age (days)`15:`Exp. Temp. (degree C)`30   0.81847    0.83487   0.980 0.327259
`Age (days)`17:`Exp. Temp. (degree C)`30   0.32236    0.83487   0.386 0.699532
`Age (days)`19:`Exp. Temp. (degree C)`30   0.48402    0.83487   0.580 0.562269
`Age (days)`21:`Exp. Temp. (degree C)`30   0.81124    0.83487   0.972 0.331543
`Age (days)`23:`Exp. Temp. (degree C)`30   1.94180    0.83487   2.326 0.020316
`Age (days)`25:`Exp. Temp. (degree C)`30   2.24569    0.83487   2.690 0.007322
`Age (days)`27:`Exp. Temp. (degree C)`30   1.05569    0.83487   1.264 0.206483
`Age (days)`29:`Exp. Temp. (degree C)`30   1.48013    0.83487   1.773 0.076690
`Age (days)`34:`Exp. Temp. (degree C)`30   1.44458    0.83487   1.730 0.084026
`Age (days)`39:`Exp. Temp. (degree C)`30   1.22624    0.83487   1.469 0.142350
`Age (days)`44:`Exp. Temp. (degree C)`30   1.43902    0.83487   1.724 0.085222
`Age (days)`49:`Exp. Temp. (degree C)`30   0.40347    0.83487   0.483 0.629060
`Age (days)`51:`Exp. Temp. (degree C)`30   1.51180    0.83487   1.811 0.070606
`Age (days)`66:`Exp. Temp. (degree C)`30   0.76513    0.83487   0.916 0.359744
`Age (days)`80:`Exp. Temp. (degree C)`30   3.02987    0.84887   3.569 0.000383
`Age (days)`123:`Exp. Temp. (degree C)`30  0.68902    0.83487   0.825 0.409487
                                             
(Intercept)                               ***
`Age (days)`7                                
`Age (days)`9                             ***
`Age (days)`11                            ***
`Age (days)`13                            ***
`Age (days)`15                            ***
`Age (days)`17                            ***
`Age (days)`19                            ***
`Age (days)`21                            ***
`Age (days)`23                            ***
`Age (days)`25                            ***
`Age (days)`27                            ***
`Age (days)`29                            ***
`Age (days)`34                            ***
`Age (days)`39                            ***
`Age (days)`44                            ***
`Age (days)`49                            ***
`Age (days)`51                            ***
`Age (days)`66                            ***
`Age (days)`80                            ***
`Age (days)`123                           ***
`Exp. Temp. (degree C)`30                    
`Bird #`2                                 ***
`Bird #`3                                    
`Bird #`4                                 .  
`Bird #`5                                 ***
`Bird #`6                                 .  
`Bird #`7                                 ** 
`Bird #`8                                    
`Bird #`9                                 ***
`Bird #`10                                ** 
`Bird #`11                                ** 
`Bird #`12                                   
`Bird #`13                                   
`Bird #`14                                *  
`Bird #`15                                   
`Bird #`16                                ***
`Bird #`17                                *  
`Bird #`18                                   
`Bird #`19                                ***
`Bird #`20                                   
`Bird #`21                                   
`Bird #`22                                   
`Bird #`23                                   
`Bird #`24                                   
`Bird #`25                                   
`Bird #`26                                   
`Bird #`27                                   
`Bird #`28                                   
`Bird #`29                                ** 
`Bird #`30                                   
`Bird #`31                                   
`Bird #`32                                   
`Bird #`33                                   
`Bird #`34                                   
`Bird #`35                                   
`Bird #`36                                   
`Bird #`37                                   
`Bird #`38                                   
`Bird #`39                                   
`Bird #`40                                   
`Age (days)`7:`Exp. Temp. (degree C)`30      
`Age (days)`9:`Exp. Temp. (degree C)`30      
`Age (days)`11:`Exp. Temp. (degree C)`30     
`Age (days)`13:`Exp. Temp. (degree C)`30     
`Age (days)`15:`Exp. Temp. (degree C)`30     
`Age (days)`17:`Exp. Temp. (degree C)`30     
`Age (days)`19:`Exp. Temp. (degree C)`30     
`Age (days)`21:`Exp. Temp. (degree C)`30     
`Age (days)`23:`Exp. Temp. (degree C)`30  *  
`Age (days)`25:`Exp. Temp. (degree C)`30  ** 
`Age (days)`27:`Exp. Temp. (degree C)`30     
`Age (days)`29:`Exp. Temp. (degree C)`30  .  
`Age (days)`34:`Exp. Temp. (degree C)`30  .  
`Age (days)`39:`Exp. Temp. (degree C)`30     
`Age (days)`44:`Exp. Temp. (degree C)`30  .  
`Age (days)`49:`Exp. Temp. (degree C)`30     
`Age (days)`51:`Exp. Temp. (degree C)`30  .  
`Age (days)`66:`Exp. Temp. (degree C)`30     
`Age (days)`80:`Exp. Temp. (degree C)`30  ***
`Age (days)`123:`Exp. Temp. (degree C)`30    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.798 on 688 degrees of freedom
  (112 observations deleted due to missingness)
Multiple R-squared:  0.9361,    Adjusted R-squared:  0.9288 
F-statistic: 127.7 on 79 and 688 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># model.matrix(tarsus_lm)</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Viz the model</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a><span class="co"># emmeans</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>tarsus_em <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(tarsus_lm,</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>                   <span class="at">spec =</span> <span class="sc">~</span><span class="fu">c</span>(<span class="st">`</span><span class="at">Age (days)</span><span class="st">`</span>, <span class="st">`</span><span class="at">Exp. Temp. (degree C)</span><span class="st">`</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>NOTE: A nesting structure was detected in the fitted model:
    Bird # %in% Exp. Temp. (degree C)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>tarsus_em</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Age (days) Exp. Temp. (degree C) emmean    SE  df lower.CL upper.CL
 5          15                      19.7 0.402 688     18.9     20.5
 7          15                      20.2 0.402 688     19.4     21.0
 9          15                      22.4 0.402 688     21.6     23.2
 11         15                      24.4 0.402 688     23.6     25.1
 13         15                      25.1 0.429 688     24.3     26.0
 15         15                      26.3 0.429 688     25.5     27.2
 17         15                      28.1 0.429 688     27.3     29.0
 19         15                      29.4 0.429 688     28.5     30.2
 21         15                      30.8 0.429 688     30.0     31.7
 23         15                      31.8 0.429 688     30.9     32.6
 25         15                      33.4 0.429 688     32.6     34.2
 27         15                      34.7 0.429 688     33.9     35.6
 29         15                      35.2 0.429 688     34.3     36.0
 34         15                      37.1 0.429 688     36.3     37.9
 39         15                      36.9 0.429 688     36.1     37.8
 44         15                      36.9 0.429 688     36.0     37.7
 49         15                      36.6 0.429 688     35.8     37.5
 51         15                      35.8 0.429 688     35.0     36.7
 66         15                      37.2 0.429 688     36.3     38.0
 80         15                      36.3 0.456 688     35.4     37.2
 123        15                      38.1 0.429 688     37.2     38.9
 5          30                      19.8 0.402 688     19.0     20.6
 7          30                      20.2 0.423 688     19.3     21.0
 9          30                      23.1 0.423 688     22.2     23.9
 11         30                      24.3 0.423 688     23.5     25.2
 13         30                      26.5 0.423 688     25.7     27.4
 15         30                      27.2 0.436 688     26.4     28.1
 17         30                      28.5 0.436 688     27.7     29.4
 19         30                      29.9 0.436 688     29.1     30.8
 21         30                      31.7 0.436 688     30.9     32.6
 23         30                      33.8 0.436 688     32.9     34.7
 25         30                      35.7 0.436 688     34.9     36.6
 27         30                      35.9 0.436 688     35.0     36.7
 29         30                      36.7 0.436 688     35.9     37.6
 34         30                      38.6 0.436 688     37.8     39.5
 39         30                      38.2 0.436 688     37.4     39.1
 44         30                      38.4 0.436 688     37.5     39.2
 49         30                      37.1 0.436 688     36.2     38.0
 51         30                      37.4 0.436 688     36.6     38.3
 66         30                      38.0 0.436 688     37.2     38.9
 80         30                      39.4 0.436 688     38.5     40.2
 123        30                      38.8 0.436 688     38.0     39.7

Results are averaged over the levels of: Bird # 
Confidence level used: 0.95 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># viz the emmeans</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="fu">as.data.frame</span>(tarsus_em) <span class="sc">|&gt;</span> </span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">Age (days)</span><span class="st">`</span>,</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> emmean)) <span class="sc">+</span> </span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> <span class="st">`</span><span class="at">Exp. Temp. (degree C)</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"red"</span>)) <span class="sc">+</span> </span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">reverse =</span> <span class="cn">TRUE</span>)) <span class="sc">+</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_linerange</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> lower.CL,</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>                     <span class="at">ymax =</span> upper.CL),</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> <span class="st">"grey"</span>,</span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>                 <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Post-Hatch Temperature as a Determinant of Quail Tarsus Length"</span>,</span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Warmer post-hatch environments may moderately increase tarsus length"</span>,</span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Modeled Mean Tarsus length (mm)"</span>,</span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">"Figure 1 - Error bars indicate 95% CI of modeled marginal means"</span>) <span class="sc">+</span></span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.caption.position =</span> <span class="st">"plot"</span>,</span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="midterm_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>tarsus_em_temp <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(tarsus_lm,</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">spec =</span> <span class="sc">~</span><span class="st">`</span><span class="at">Exp. Temp. (degree C)</span><span class="st">`</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>NOTE: A nesting structure was detected in the fitted model:
    Bird # %in% Exp. Temp. (degree C)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>tarsus_em_temp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Exp. Temp. (degree C) emmean    SE  df lower.CL upper.CL
 15                      31.3 0.107 688     31.0     31.5
 30                      32.4 0.131 688     32.1     32.6

Results are averaged over the levels of: Age (days), Bird # 
Confidence level used: 0.95 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as.data.frame</span>(tarsus_em_temp) <span class="sc">|&gt;</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">Exp. Temp. (degree C)</span><span class="st">`</span>,</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> emmean)) <span class="sc">+</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_linerange</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> lower.CL,</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>                     <span class="at">ymax =</span> upper.CL),</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Post-Hatch Temperature as a Determinant of Quail Tarsus Length"</span>,</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Overall, warmer post-hatch environments appear to increase tarsus length"</span>,</span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Modeled Mean Tarsus length (mm)"</span>,</span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">"Figure 2 - Error bars indicate 95% CI of modeled marginal means"</span>) <span class="sc">+</span></span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.caption.position =</span> <span class="st">"plot"</span>,</span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="midterm_files/figure-html/unnamed-chunk-10-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>So to answer the question</strong> - It does appear that temperature affects the development of tarsus length overall, as demonstrated by Figure 2 above. However, Figure 1 reveals that at any given age, we don’t have a lot of confidence that the mean tarsus length will be different, although this confidence appears to increase with age.</p>
</section>
<section id="something-generalized" class="level2">
<h2 class="anchored" data-anchor-id="something-generalized">3. Something Generalized</h2>
<p><strong>In their 2011 paper, Stanton-Geddes and Anderson assessed the role of a facultative mutualism between a legume and soil rhizobia in limiting the plant’s range. After publishing, they deposited their data at Dryad http://datadryad.org/resource/doi:10.5061/dryad.8566. As part of their lab experiment, they looked at a variety of plant properties after growing plants with rhizobia from different regions. We want to look at what happened in that experiment during the March 12th sampling event.</strong></p>
<section id="a.-fit-a-glm" class="level3">
<h3 class="anchored" data-anchor-id="a.-fit-a-glm">3a. Fit a glm</h3>
<p><strong>Load the data. Vizualize. Then, fit and evaluate a generalized linear model with your choice of error distribution looking at the effect of rhizobial region and plant height as measured on march 12 as predictors of # of leaves on march 12. Does your model meet assumptions? If not, refit with a different. Why did you chose this (or these) error distribution(s)?</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load in the data set</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>plant_data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/greenhouse_inoculation_expt_2010.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 240 Columns: 16
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr  (4): rhizobia, rhiz_region, plant_pop, date_planted
dbl (12): rack, bench, bench_pos, rack_pos, in_leaf_num, in_height, leaf_mar...

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plant_data &lt;- read_csv("https://datadryad.org/downloads/file_stream/66224")</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="co"># str(plant_data)</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(plant_data)</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a><span class="co"># visdat::vis_dat(plant_data)</span></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize # of leaves by rhizobial region and plant height</span></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>plant_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> plant_data,</span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>                     <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> height_mar12,</span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">y =</span> leaf_mar12)) <span class="sc">+</span></span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a>plant_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="midterm_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>plant_plot <span class="sc">+</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>rhiz_region)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="midterm_files/figure-html/unnamed-chunk-11-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> plant_data,</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>      <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> rhiz_region,</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">y =</span> leaf_mar12)) <span class="sc">+</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="fu">aes</span>(<span class="at">color =</span> height_mar12)) <span class="sc">+</span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_distiller</span>(<span class="at">palette =</span> <span class="st">"Greens"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="midterm_files/figure-html/unnamed-chunk-11-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Determine best error distribution</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Predicted data is count data, and variance appears to increase with mean. </span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Try poisson distribution with log link</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>plant_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(leaf_mar12 <span class="sc">~</span> height_mar12 <span class="sc">+</span> rhiz_region,</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> plant_data)</span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit a model # of leaves ~ rhizobial region and plant </span></span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a>plant_glm <span class="ot">&lt;-</span> <span class="fu">glm</span>(leaf_mar12 <span class="sc">~</span> height_mar12 <span class="sc">+</span> rhiz_region,</span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> plant_data,</span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a>                 <span class="at">family =</span> <span class="fu">poisson</span>(<span class="at">link =</span> <span class="st">"log"</span>))</span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a><span class="co"># plant_glm &lt;- glmmTMB(leaf_mar12 ~ height_mar12 + rhiz_region,</span></span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a><span class="co">#                  data = plant_data,</span></span>
<span id="cb40-18"><a href="#cb40-18" aria-hidden="true" tabindex="-1"></a><span class="co">#                  family = nbinom2(link = "log"))</span></span>
<span id="cb40-19"><a href="#cb40-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-20"><a href="#cb40-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-21"><a href="#cb40-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Check assumptions</span></span>
<span id="cb40-22"><a href="#cb40-22" aria-hidden="true" tabindex="-1"></a><span class="fu">check_model</span>(plant_glm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="midterm_files/figure-html/unnamed-chunk-11-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">simulateResiduals</span>(plant_glm) <span class="sc">|&gt;</span> <span class="fu">plot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="midterm_files/figure-html/unnamed-chunk-11-5.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># It's not perfect, but honestly looks pretty good. </span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="co"># I also tried negative binomial distribution but it didn't look any better. </span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="co"># I tried a Gamma distribution, and it did seem better, but I kept it as a Poisson distribution </span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a><span class="co"># because the predicted value is discrete count data, not continuous, so I wasn't sure if</span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Gamma would be appropriate</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="b.-evaluate-your-treatments" class="level3">
<h3 class="anchored" data-anchor-id="b.-evaluate-your-treatments">3b. Evaluate your treatments</h3>
<p><strong>Which rhizobial regions enable more leaves relative to the control? And in what direction?</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># tidy(plant_glm)</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="co"># r2(plant_glm)</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Use emmeans for marginal means be rhiz_region</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>plant_means <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(plant_glm,</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>                      <span class="at">specs =</span> <span class="sc">~</span>rhiz_region,</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>                      <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a><span class="co"># See how predicted mean for c controls to other regions</span></span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>plant_means</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> rhiz_region rate    SE  df asymp.LCL asymp.UCL
 beyond      8.46 0.458 Inf      7.61      9.41
 c           6.46 0.405 Inf      5.72      7.31
 edge        7.86 0.339 Inf      7.22      8.56
 interior    7.88 0.304 Inf      7.31      8.50

Confidence level used: 0.95 
Intervals are back-transformed from the log scale </code></pre>
</div>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>plant_means <span class="sc">|&gt;</span> <span class="fu">plot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="midterm_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check out pairwise comparisons</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>plant_means <span class="sc">|&gt;</span> <span class="fu">contrast</span>(<span class="st">"pairwise"</span>) <span class="sc">|&gt;</span> <span class="fu">confint</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> contrast          ratio     SE  df asymp.LCL asymp.UCL
 beyond / c        1.309 0.1080 Inf     1.058     1.619
 beyond / edge     1.076 0.0747 Inf     0.900     1.286
 beyond / interior 1.074 0.0705 Inf     0.907     1.271
 c / edge          0.822 0.0625 Inf     0.676     1.000
 c / interior      0.820 0.0603 Inf     0.679     0.991
 edge / interior   0.998 0.0585 Inf     0.858     1.160

Confidence level used: 0.95 
Conf-level adjustment: tukey method for comparing a family of 4 estimates 
Intervals are back-transformed from the log scale </code></pre>
</div>
</div>
<p>It appears that each of ther other three rhizobial regions (edge, interior, and beyond) all enable more leaves relative to the control region (c). More leaves, so direction is positive.</p>
</section>
<section id="c.-prediction-intervals-from-a-distribution" class="level3">
<h3 class="anchored" data-anchor-id="c.-prediction-intervals-from-a-distribution">3c. Prediction intervals from a distribution</h3>
<p><strong>So, your distribution has quantiles (right? We see these in QQ plots). You can see what the value for those quantiles are from the <code>q*</code> function for a distribution. For example, the 95th percentile of a poisson with a <span class="math inline">\(\lambda\)</span> of 5 spans from 1 to 10. You can see this with <code>qpois(0.025, lambda = 5)</code> for the lower, and change it to 0.975 for the upper. Check this out. Plot the upper and lower bounds of the 95th percentile of a Poisson distribution over a range of lambdas from 1 to 30. Do the same for a negative binomial with means from 1 to 30. Note, to translate from a mean (<span class="math inline">\(\mu\)</span>) with a size of 10 (you might have to look at the helpfile for qnbinom here).</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the upper and lower bounds of the 95th percentile of a Poisson distribution over a range of lambdas from 1 to 30</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>pois_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">lambdas =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">1</span>, <span class="at">to =</span> <span class="dv">30</span>, <span class="at">by =</span> <span class="dv">1</span>),</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">lower =</span> <span class="fu">qpois</span>(<span class="fl">0.025</span>, <span class="at">lambda =</span> lambdas),</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">upper =</span> <span class="fu">qpois</span>(<span class="fl">0.975</span>, <span class="at">lambda =</span> lambdas))</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Line range plot showing range from upper to lower by lambda</span></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(pois_data) <span class="sc">+</span></span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_linerange</span>(<span class="fu">aes</span>(<span class="at">x =</span> lambdas,</span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>                     <span class="at">ymin =</span> lower,</span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>                     <span class="at">ymax =</span> upper)) <span class="sc">+</span></span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"95% Reference Interval for Poisson Distribution"</span>,</span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Value of Lambda"</span>) <span class="sc">+</span></span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="midterm_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Do the same for a negative binomial with means from 1 to 30</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>nbinom_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">means =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">1</span>, <span class="at">to =</span> <span class="dv">30</span>, <span class="at">by =</span> <span class="dv">1</span>),</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">lower =</span> <span class="fu">qnbinom</span>(<span class="fl">0.025</span>, <span class="at">mu =</span> means, <span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">upper =</span> <span class="fu">qnbinom</span>(<span class="fl">0.975</span>, <span class="at">mu =</span> means, <span class="at">size =</span> <span class="dv">10</span>))</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Line range plot showing range from upper to lower by lambda</span></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(nbinom_data) <span class="sc">+</span></span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_linerange</span>(<span class="fu">aes</span>(<span class="at">x =</span> means,</span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>                     <span class="at">ymin =</span> lower,</span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>                     <span class="at">ymax =</span> upper)) <span class="sc">+</span></span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"95% Reference Interval for Negative Binomial Distribution at Size = 10"</span>,</span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Mean"</span>) <span class="sc">+</span></span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="midterm_files/figure-html/unnamed-chunk-13-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="d.-prediction-intervals-from-your-model" class="level3">
<h3 class="anchored" data-anchor-id="d.-prediction-intervals-from-your-model">3d. Prediction intervals from your model</h3>
<p><strong>All right! Armed with this knowledge, one of the frustrating things about <code>broom::augment()</code> for glm models is that it doesn’t have an <code>interval</code> argument. And has one trick. One - you need to see what scale your answer is returned on. We want to look at the response scale - the scale of the data. Second, while you can use <code>se_fit</code> to get standard errors, you don’t get a CI per se (although, hey, ~<span class="math inline">\(2*se = CI\)</span>).</strong></p>
<p><strong>AND - we just looked at how when you have an estimated value, you can get the prediction CI yourself by hand in the previous part of the question. So, using your creativity, visualize the fit, 95% fit interval, and 95% prediction interval at the min, mean, and max of height for each treatment. Geoms can be anything you like! Have fun here!</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize the fit, 95% fit interval, and 95% prediction interval at the mean</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate SE of fitted values on the response scale</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>preds <span class="ot">&lt;-</span> <span class="fu">predict</span>(plant_glm, <span class="at">type =</span> <span class="st">"response"</span>, <span class="at">se.fit =</span> <span class="cn">TRUE</span>)</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Create data frame with model data, fitted values, calculated SE, </span></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a><span class="co"># and manually calculated PIs</span></span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>plant_glm_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="fu">augment</span>(plant_glm, <span class="at">type.predict =</span> <span class="st">"response"</span>),</span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>                         <span class="at">pred_lower =</span> <span class="fu">qpois</span>(<span class="fl">0.025</span>, <span class="at">lambda =</span> .fitted),</span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>                         <span class="at">pred_upper =</span> <span class="fu">qpois</span>(<span class="fl">0.975</span>, <span class="at">lambda =</span> .fitted),</span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a>                         <span class="at">se =</span> preds<span class="sc">$</span>se.fit)</span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Create data frame with min, max, and median height values for each category</span></span>
<span id="cb50-15"><a href="#cb50-15" aria-hidden="true" tabindex="-1"></a>plant_glm_data_summary <span class="ot">&lt;-</span> plant_glm_data <span class="sc">|&gt;</span></span>
<span id="cb50-16"><a href="#cb50-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(rhiz_region) <span class="sc">|&gt;</span></span>
<span id="cb50-17"><a href="#cb50-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(height_mar12 <span class="sc">==</span> <span class="fu">min</span>(height_mar12) <span class="sc">|</span></span>
<span id="cb50-18"><a href="#cb50-18" aria-hidden="true" tabindex="-1"></a>         height_mar12 <span class="sc">==</span> <span class="fu">max</span>(height_mar12) <span class="sc">|</span></span>
<span id="cb50-19"><a href="#cb50-19" aria-hidden="true" tabindex="-1"></a>         height_mar12 <span class="sc">==</span> <span class="fu">median</span>(height_mar12))</span>
<span id="cb50-20"><a href="#cb50-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Note - I wasn't sure how to do this with the mean so I tried with the median... of course that also</span></span>
<span id="cb50-21"><a href="#cb50-21" aria-hidden="true" tabindex="-1"></a><span class="co"># didn't work where there were an even number of values, so the plot below is missing </span></span>
<span id="cb50-22"><a href="#cb50-22" aria-hidden="true" tabindex="-1"></a><span class="co"># one of the center PI bars.</span></span>
<span id="cb50-23"><a href="#cb50-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-24"><a href="#cb50-24" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> plant_glm_data,</span>
<span id="cb50-25"><a href="#cb50-25" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> height_mar12)) <span class="sc">+</span></span>
<span id="cb50-26"><a href="#cb50-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> leaf_mar12)) <span class="sc">+</span></span>
<span id="cb50-27"><a href="#cb50-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> .fitted),</span>
<span id="cb50-28"><a href="#cb50-28" aria-hidden="true" tabindex="-1"></a>            <span class="at">linewidth =</span> <span class="fl">1.5</span>,</span>
<span id="cb50-29"><a href="#cb50-29" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">"green"</span>, </span>
<span id="cb50-30"><a href="#cb50-30" aria-hidden="true" tabindex="-1"></a>            <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb50-31"><a href="#cb50-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> .fitted <span class="sc">-</span> <span class="dv">2</span><span class="sc">*</span>se, <span class="at">ymax =</span> .fitted <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span>se),</span>
<span id="cb50-32"><a href="#cb50-32" aria-hidden="true" tabindex="-1"></a>              <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span> </span>
<span id="cb50-33"><a href="#cb50-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_linerange</span>(<span class="at">data =</span> plant_glm_data_summary,</span>
<span id="cb50-34"><a href="#cb50-34" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">aes</span>(<span class="at">ymin =</span> pred_lower, <span class="at">ymax =</span> pred_upper),</span>
<span id="cb50-35"><a href="#cb50-35" aria-hidden="true" tabindex="-1"></a>              <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb50-36"><a href="#cb50-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>rhiz_region) <span class="sc">+</span></span>
<span id="cb50-37"><a href="#cb50-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Predicted Leaf Counts Plotted over Actual Data"</span>,</span>
<span id="cb50-38"><a href="#cb50-38" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">"Plot is facetted by treatment. Ribbons indicate 95% confidence interval.</span></span>
<span id="cb50-39"><a href="#cb50-39" aria-hidden="true" tabindex="-1"></a><span class="st">       Line ranges indicate 95% prediction intervals at min, median, and max."</span>,</span>
<span id="cb50-40"><a href="#cb50-40" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Plant Height (Inches) on March 12th"</span>,</span>
<span id="cb50-41"><a href="#cb50-41" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Predicted March 12th Leaf Count"</span>) <span class="sc">+</span></span>
<span id="cb50-42"><a href="#cb50-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb50-43"><a href="#cb50-43" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>), </span>
<span id="cb50-44"><a href="#cb50-44" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="midterm_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="e.-inmpress-yourself-prediction-intervals-from-your-model" class="level3">
<h3 class="anchored" data-anchor-id="e.-inmpress-yourself-prediction-intervals-from-your-model">3e. INMPRESS YOURSELF! Prediction intervals from your model</h3>
<p><strong>Again, totally optional, but, check out the sinterval package which you’d have to install from github. It uses fit models and it’s two core functions <code>add_fitted_sims()</code> and <code>add_predicted_sims()</code> to get simulated values from fit models using one or the other interval. Do this, and visualize the same thing as above however you’d like (maybe look at <code>ggdist</code>?). Or try something new? Perhaps visualize across a range of heights, and not just three?</strong></p>
</section>
</section>
<section id="mix-it-up" class="level2">
<h2 class="anchored" data-anchor-id="mix-it-up">4. Mix it up!</h2>
<p><strong>To explore the consequences of random effects, we are going to look at an example from Vonesh, J. R. and Bolker, B. M. (2005). Compensatory larval responses shift trade-offs associated with predator-induced hatching plasticity. Ecology, 86:1580–1591. In the paper, one thing they explore is the effect of tank size, predator presence, and prey density on larval tadpoles. They go on to look at induced plastic defenses in those tadpoles. It’s a cool paper, and worth a look! But, it also shows something really interesting about logistic regression models - namely, when should we consider them as mixed models.</strong></p>
<section id="a.-load-it-up-and-plot" class="level3">
<h3 class="anchored" data-anchor-id="a.-load-it-up-and-plot">4a. Load it up and plot</h3>
<p>Load the data with the following code:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>reedfrogs <span class="ot">&lt;-</span> <span class="fu">read_delim</span>(<span class="st">"https://github.com/rmcelreath/rethinking/raw/master/data/reedfrogs.csv"</span>,</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>                        <span class="at">delim =</span> <span class="st">";"</span>) <span class="sc">|&gt;</span></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">tank =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>() <span class="sc">|&gt;</span> <span class="fu">as.character</span>(),</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">died =</span> density <span class="sc">-</span> surv)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 48 Columns: 5
── Column specification ────────────────────────────────────────────────────────
Delimiter: ";"
chr (2): pred, size
dbl (3): density, surv, propsurv

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
</div>
<p><strong>To get used to the data, plot survivorship as a function of tank size and predator treatment. Then, to challenge yourself a bit. Expand the data to 1s and 0s (lived or died) as follows:</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot survivorship as a function of tank size and predator treatment</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> reedfrogs,</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> size,</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">y =</span> surv,</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">color =</span> pred)) <span class="sc">+</span></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>() <span class="sc">+</span></span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">width =</span> <span class="fl">0.3</span>, <span class="at">height =</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="midterm_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>reedfrogs_expanded <span class="ot">&lt;-</span> reedfrogs <span class="sc">|&gt;</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(tank, size, pred, density) <span class="sc">|&gt;</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">reframe</span>(<span class="at">status =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>, surv), <span class="fu">rep</span>(<span class="dv">0</span>, died))) <span class="sc">|&gt;</span></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Now with the expanded data, plot it showing who lived, who died (who tells their story…), and how that corresponds to treatment AND tank. Do you see anything to do with within-tank variability?</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># I am interpreting "showing who lived, who died" to mean plot every single data point, 0 or 1...</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(reedfrogs_expanded,</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(<span class="fu">as.numeric</span>(tank)),</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> <span class="fu">as.character</span>(status),</span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> size)) <span class="sc">+</span></span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>pred) <span class="sc">+</span></span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Individual Survival of Larval Tidepoles"</span>, </span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Each dot represents an individual - plot facetted by predator presence"</span>,</span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Tank Number"</span>,</span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Survival Status"</span>,</span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Tank Size"</span>) <span class="sc">+</span></span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">5</span>),</span>
<span id="cb55-14"><a href="#cb55-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="midterm_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>It seems to be that there is much more within tank variability when predators are not present</p>
</section>
<section id="b.-are-you-over-it" class="level3">
<h3 class="anchored" data-anchor-id="b.-are-you-over-it">4b. Are you over it?</h3>
<p><strong>Often, we treat data like this as a binomial logistic regression. We look at each tank as a set of ‘coin flips’ - some living some dead. Fit a glm here with survivorship determined by <code>pred*size</code>, and then evaluate it for overdispersion. Careful to weight for number of individuals stocked in a tank (density)! What do you see when you look at overdispersion?</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit a glm with survivorship determined by `pred*size`</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>tadpole_glm <span class="ot">&lt;-</span> <span class="fu">glm</span>(status <span class="sc">~</span> pred<span class="sc">*</span>size,</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">weights =</span> density,</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>),</span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> reedfrogs_expanded)</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Evaluate for overdispersion. Careful to weight for number of individuals stocked in a </span></span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a><span class="co"># tank (density)!</span></span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a><span class="fu">check_overdispersion</span>(tadpole_glm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Overdispersion test

 dispersion ratio =   2.323
          p-value = &lt; 0.001</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Overdispersion detected.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Overdispersion is detected</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a><span class="co"># check_overdispersion(tadpole_glm) |&gt; plot()</span></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a><span class="co"># ^Doesn't work the same as in class...</span></span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a><span class="fu">simulateResiduals</span>(tadpole_glm) <span class="sc">|&gt;</span> <span class="fu">plot</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>DHARMa:testOutliers with type = binomial may have inflated Type I error rates for integer-valued distributions. To get a more exact result, it is recommended to re-run testOutliers with type = 'bootstrap'. See ?testOutliers for details</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="midterm_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">simulateResiduals</span>(tadpole_glm) <span class="sc">|&gt;</span> <span class="fu">plotQQunif</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>DHARMa:testOutliers with type = binomial may have inflated Type I error rates for integer-valued distributions. To get a more exact result, it is recommended to re-run testOutliers with type = 'bootstrap'. See ?testOutliers for details</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="midterm_files/figure-html/unnamed-chunk-18-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>When we look at overdispersion it appears that the modeled and observed residuals don’t align at all.</p>
</section>
<section id="c.-fixed-or-random-intercept" class="level3">
<h3 class="anchored" data-anchor-id="c.-fixed-or-random-intercept">4c. Fixed or Random Intercept</h3>
<p><strong>One way to fix this problem is a quasi-binomial. But, this is unsatisfying, as it’s a posthoc adjustment and not figured into the likelihood. But, another is to think in this case about what is happening in each tank. Fit a mixed model version of 5b, and assess its assumptions. How does it compare in overdispersion? Why the difference? What is a random tank effect doing here? And why couldn’t we use a FE of tank with this <code>pred*size</code> model (try it if you don’t believe me - the model will fit, but something will be… off)?</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit a mixed model version of 5b</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>tadpole_mixed <span class="ot">&lt;-</span> <span class="fu">glmer</span>(status <span class="sc">~</span> pred<span class="sc">*</span>size <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> tank),</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">weights =</span> density,</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>),</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">data =</span> reedfrogs_expanded)</span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Check assumptions (including overdispersion)</span></span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a><span class="fu">check_model</span>(tadpole_mixed)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="midterm_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">check_overdispersion</span>(tadpole_mixed)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Overdispersion test

 dispersion ratio =   2.073
          p-value = &lt; 0.001</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Overdispersion detected.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Overdispersion is still detected </span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a><span class="co"># check_overdispersion(tadpole_glm) |&gt; plot()</span></span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a><span class="co"># ^Doesn't work the same as in class...</span></span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a><span class="fu">simulateResiduals</span>(tadpole_mixed) <span class="sc">|&gt;</span> <span class="fu">plot</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>DHARMa:testOutliers with type = binomial may have inflated Type I error rates for integer-valued distributions. To get a more exact result, it is recommended to re-run testOutliers with type = 'bootstrap'. See ?testOutliers for details</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="midterm_files/figure-html/unnamed-chunk-19-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">simulateResiduals</span>(tadpole_mixed) <span class="sc">|&gt;</span> <span class="fu">plotQQunif</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>DHARMa:testOutliers with type = binomial may have inflated Type I error rates for integer-valued distributions. To get a more exact result, it is recommended to re-run testOutliers with type = 'bootstrap'. See ?testOutliers for details</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="midterm_files/figure-html/unnamed-chunk-19-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Overdispersion still looked terrible. I must be doing something wrong, but no matter how I change the model, if I include weights = density as was requested, the model doesn’t seem to pass assumptions.</p>
</section>
<section id="d.-changes-in-parameters" class="level3">
<h3 class="anchored" data-anchor-id="d.-changes-in-parameters">4d. Changes in Parameters</h3>
<p><strong>Now that you have a model with and without a random intercept, how do the estimates of fixed effects change? Why</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(tadpole_glm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 5
  term               estimate std.error statistic  p.value
  &lt;chr&gt;                 &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
1 (Intercept)           2.67     0.0460     58.0  0       
2 predpred             -3.38     0.0519    -65.1  0       
3 sizesmall            -0.176    0.0627     -2.81 4.92e- 3
4 predpred:sizesmall    1.17     0.0710     16.5  3.87e-61</code></pre>
</div>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(tadpole_mixed)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 7
  effect   group term               estimate std.error statistic   p.value
  &lt;chr&gt;    &lt;chr&gt; &lt;chr&gt;                 &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
1 fixed    &lt;NA&gt;  (Intercept)           3.14      0.376     8.34   7.21e-17
2 fixed    &lt;NA&gt;  predpred             -3.48      0.519    -6.71   1.97e-11
3 fixed    &lt;NA&gt;  sizesmall            -0.289     0.524    -0.551  5.81e- 1
4 fixed    &lt;NA&gt;  predpred:sizesmall    1.24      0.728     1.70   8.98e- 2
5 ran_pars tank  sd__(Intercept)       1.22     NA        NA     NA       </code></pre>
</div>
</div>
<p>The estimate of intercept is notably different, which makes sense since the intercept is allowed to vary by tank in the model with a random intercept. The other fixed effects (slopes of predicters and interaction) are very similar, but slightly stronger (absolute values of estimates are larger) for the model with the random intercept. In particular the sizesmall intercept is much stronger in the mixed mode. Perhaps the slopes are stronger in the mixed model because by isolating what’s an effect of tank, the real impact of each predictor can more accurately be estimated.</p>
</section>
<section id="e.-model-evaluation" class="level3">
<h3 class="anchored" data-anchor-id="e.-model-evaluation">4e. Model evaluation</h3>
<p><strong>Last, let’s evaluate this model - both with contrasts and a crisp visualization of results. <code>emmeans</code>, <code>modelbased</code>, and other friends might help you here. Or not! You do you, and extract things from the model with other helpers! There’s no one right way to do this, but, make it sing.</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="fu">emmeans</span>(tadpole_mixed, <span class="at">specs =</span> <span class="sc">~</span>pred<span class="sc">*</span>size, <span class="at">type =</span> <span class="st">"response"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> pred size   prob     SE  df asymp.LCL asymp.UCL
 no   big   0.959 0.0150 Inf     0.917     0.980
 pred big   0.416 0.0866 Inf     0.262     0.589
 no   small 0.945 0.0190 Inf     0.894     0.973
 pred small 0.648 0.0815 Inf     0.477     0.787

Confidence level used: 0.95 
Intervals are back-transformed from the logit scale </code></pre>
</div>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">emmeans</span>(tadpole_mixed, <span class="at">specs =</span> <span class="sc">~</span>pred <span class="sc">|</span> size, <span class="at">type =</span> <span class="st">"response"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>size = big:
 pred  prob     SE  df asymp.LCL asymp.UCL
 no   0.959 0.0150 Inf     0.917     0.980
 pred 0.416 0.0866 Inf     0.262     0.589

size = small:
 pred  prob     SE  df asymp.LCL asymp.UCL
 no   0.945 0.0190 Inf     0.894     0.973
 pred 0.648 0.0815 Inf     0.477     0.787

Confidence level used: 0.95 
Intervals are back-transformed from the logit scale </code></pre>
</div>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">emmeans</span>(tadpole_mixed, <span class="at">specs =</span> <span class="sc">~</span>size <span class="sc">|</span> pred, <span class="at">type =</span> <span class="st">"response"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>pred = no:
 size   prob     SE  df asymp.LCL asymp.UCL
 big   0.959 0.0150 Inf     0.917     0.980
 small 0.945 0.0190 Inf     0.894     0.973

pred = pred:
 size   prob     SE  df asymp.LCL asymp.UCL
 big   0.416 0.0866 Inf     0.262     0.589
 small 0.648 0.0815 Inf     0.477     0.787

Confidence level used: 0.95 
Intervals are back-transformed from the logit scale </code></pre>
</div>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="co"># These all say the same thing, but basically predict that survival is likely when there is no </span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a><span class="co"># predator, and when there is a predator, the survival rate is predicted to be higher</span></span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a><span class="co"># in a small tank (which is a little counterintuative)</span></span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot predicted values and 95% CI with estimate_relation</span></span>
<span id="cb81-7"><a href="#cb81-7" aria-hidden="true" tabindex="-1"></a><span class="fu">estimate_relation</span>(tadpole_mixed) <span class="sc">|&gt;</span> <span class="fu">plot</span>() <span class="sc">+</span></span>
<span id="cb81-8"><a href="#cb81-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Predicted Mean Chance of Tadpole Survival"</span>,</span>
<span id="cb81-9"><a href="#cb81-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"with 95% confidence intervals"</span>,</span>
<span id="cb81-10"><a href="#cb81-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Presence of Predator"</span>,</span>
<span id="cb81-11"><a href="#cb81-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Predicted Mean Chance of Survival"</span>,</span>
<span id="cb81-12"><a href="#cb81-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Tank Size"</span>) <span class="sc">+</span></span>
<span id="cb81-13"><a href="#cb81-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb81-14"><a href="#cb81-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="midterm_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="f.-impress-yourself-variable-slopes" class="level3">
<h3 class="anchored" data-anchor-id="f.-impress-yourself-variable-slopes">4f. IMPRESS YOURSELF! Variable slopes</h3>
<p><strong>Explore multiple different RE structures beyond a variable intercept. What errors do you get? What do they mean? Can you implement some of the suggested solutions, and what do they tell you about why more complex structures don’t work well here and/or might not be appropriate. Do these different RE structures make a difference for your evaluation of the FE? What RE structure would you use? What if you added density as a covariate/predictor as in the paper?</strong></p>
</section>
</section>
<section id="what-did-we-do" class="level2">
<h2 class="anchored" data-anchor-id="what-did-we-do">5. What did we do</h2>
<p><strong>Write out the model equations for the glmm you have fit in 4.3. Use LaTeX to write it all out. Explain what your symbols mean in text.</strong></p>
<p><span class="math inline">\(logit(P(status_{ij} = 1)) = \beta_0 + \beta_1pred_{ij} + \beta_2size_{ij} + \beta_3(pred_{ij} \times size_{ij}) +  \alpha_j + \epsilon_{ij}\)</span></p>
<p><span class="math inline">\(\alpha_j \sim \mathcal{N}(0, \sigma^2_\alpha)\)</span></p>
<p><span class="math inline">\(\epsilon_{ij} \sim \mathcal{N}(0, \sigma^2)\)</span></p>
<p>where <span class="math inline">\(i\)</span> is an idividual observation, <span class="math inline">\(j\)</span> represents the tank, and <span class="math inline">\(/alpha\)</span> is the random effect of the tank on the intercept.</p>
</section>
</section>
<section id="midterm-self-evaluation" class="level1">
<h1>Midterm Self-Evaluation</h1>
<section id="a.-how-are-you-doing" class="level3">
<h3 class="anchored" data-anchor-id="a.-how-are-you-doing">A. How are you doing?</h3>
<p>I thought I was doing well but this midterm took me an incredible amount of time, much of it just staring at the screen feeling confused about the questions. I’m not feeling confident.</p>
</section>
<section id="b.-what-concepts-do-you-think-youve-really-mastered-or-are-on-the-journey-to-mastery---i-know-youre-still-learning-in-this-class" class="level3">
<h3 class="anchored" data-anchor-id="b.-what-concepts-do-you-think-youve-really-mastered-or-are-on-the-journey-to-mastery---i-know-youre-still-learning-in-this-class">B. What concepts do you think you’ve really mastered (or are on the journey to mastery - I know, you’re still learning) in this class?</h3>
<p>The basic linear model! I feel like I conceptually understand the glms and mixed models, but then when it comes to applying them I just get lost. But I’m on the way.</p>
</section>
<section id="c.-what-in-this-class-do-you-find-easy" class="level3">
<h3 class="anchored" data-anchor-id="c.-what-in-this-class-do-you-find-easy">C. What in this class do you find easy?</h3>
<p>Very little.</p>
</section>
<section id="d.-how-would-you-describe-your-personal-journey-with-learning-to-code" class="level3">
<h3 class="anchored" data-anchor-id="d.-how-would-you-describe-your-personal-journey-with-learning-to-code">D. How would you describe your personal journey with learning to code?</h3>
<p>Satisfying growth in some directions, painful, slow growth in others.<br>
I like the procedural neatness of code, but I am feeling frustrated because I feel like it’s supposed to make things more efficient, but everything I do feels excruciatingly slow because when I’m applying concepts I’m not an expert in while trying to code, everything is just so slow.</p>
</section>
<section id="e.-where-do-you-see-applying-coding-in-your-life-outside-of-just-stats" class="level3">
<h3 class="anchored" data-anchor-id="e.-where-do-you-see-applying-coding-in-your-life-outside-of-just-stats">E. Where do you see applying coding in your life outside of just stats?</h3>
<p>Well, other data analysis, but I guess that’s stats.<br>
I could see myself making small apps for certain work/academic projects in the future, for myself or others to interact with I suppose. I’m not sure in what form.</p>
</section>
<section id="f.-where-do-you-see-the-most-opportunities-for-growth-in-your-abilities" class="level3">
<h3 class="anchored" data-anchor-id="f.-where-do-you-see-the-most-opportunities-for-growth-in-your-abilities">F. Where do you see the most opportunities for growth in your abilities?</h3>
<p>Concepts, and familiarity with all the packages that are out there to save me time. Also, I really need to improve my ability to garner relevant inforation from the help section in R - I use it a lot, but often get confused by the language.</p>
</section>
<section id="g.-talk-about-your-work-in-this-course.-what-have-you-done-what-havent-you-done-how-has-this-been-helpful-to-your-growth---or-not" class="level3">
<h3 class="anchored" data-anchor-id="g.-talk-about-your-work-in-this-course.-what-have-you-done-what-havent-you-done-how-has-this-been-helpful-to-your-growth---or-not">G. Talk about your work in this course. What have you done? What haven’t you done? How has this been helpful to your growth - or not?</h3>
<p>I review the labs, I google (a lot). I stare at the screen. I haven’t been great about working with others or going to office hours, I’ll admit. I think the independent trouble shooting is good for my growth in some ways, but I really need to be interacting with other more to contextualize this skillset.</p>
</section>
<section id="h.-did-you-find-yourself-stretching-your-abilities-in-this-exam-or-did-it-just-feel-like-wrote-comfortable-work-tell-me-about-it." class="level3">
<h3 class="anchored" data-anchor-id="h.-did-you-find-yourself-stretching-your-abilities-in-this-exam-or-did-it-just-feel-like-wrote-comfortable-work-tell-me-about-it.">H. Did you find yourself stretching your abilities in this exam? Or did it just feel like wrote comfortable work? Tell me about it.</h3>
<p>Honestly, I felt confused by the questions often. Overall this exam took me forever, so I would say yes my abilities (and comprehension) were stretched. It was not comfortable. I generally follow the labs, but often it seemed like there were conceptual leaps that needed to be made from the labs, and I aparently wasn’t quite ready to make those confortably.</p>
</section>
<section id="i.-how-would-you-assess-yourself-from-this-exam---weaksufficientstrong.-why" class="level3">
<h3 class="anchored" data-anchor-id="i.-how-would-you-assess-yourself-from-this-exam---weaksufficientstrong.-why">I. How would you assess yourself from this exam - weak/sufficient/strong. Why?</h3>
<p>Sufficient. I don’t think some of my models are how they should be, and I didn’t evaluate and visualize to the quality/completeness that I would have liked to because I had just spent so much time already and needed to be done.</p>
</section>
<section id="j.-how-would-you-assess-yourself-on-the-first-half-of-this-course---weaksufficientstrong-why" class="level3">
<h3 class="anchored" data-anchor-id="j.-how-would-you-assess-yourself-on-the-first-half-of-this-course---weaksufficientstrong-why">J. How would you assess yourself on the first half of this course - weak/sufficient/strong? Why?</h3>
<p>Strong minus? I mean I felt really strong, until this exam. Even though I think I’ve followed the class well and done well on assignments, I was not able to apply the concepts as well as I would have liked to on the exam. And I need to be able to do these things faster!</p>
</section>
<section id="k.-what-goals-do-you-have-for-yourself-for-the-rest-of-the-course-what-do-you-hope-to-accomplish-and-how-will-this-move-you-forward" class="level3">
<h3 class="anchored" data-anchor-id="k.-what-goals-do-you-have-for-yourself-for-the-rest-of-the-course-what-do-you-hope-to-accomplish-and-how-will-this-move-you-forward">K. What goals do you have for yourself for the rest of the course? What do you hope to accomplish, and how will this move you forward?</h3>
<p>Get faster at some of the basic stuff, and really just be able to understand the foundational math a bit more, and when/how/why to use certain approaches in R.</p>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>