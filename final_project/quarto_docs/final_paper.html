<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Aaron Shavitz">
<meta name="dcterms.date" content="2025-05-03">

<title>Impact of Summer SST Anomalies on Northeastern US Eelgrass Cover</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="final_paper_files/libs/clipboard/clipboard.min.js"></script>
<script src="final_paper_files/libs/quarto-html/quarto.js"></script>
<script src="final_paper_files/libs/quarto-html/popper.min.js"></script>
<script src="final_paper_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="final_paper_files/libs/quarto-html/anchor.min.js"></script>
<link href="final_paper_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="final_paper_files/libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="final_paper_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="final_paper_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="final_paper_files/libs/bootstrap/bootstrap-c0367b04c37547644fece4185067e4a7.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script src="final_paper_files/libs/kePrint-0.0.1/kePrint.js"></script>
<link href="final_paper_files/libs/lightable-0.0.1/lightable.css" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Impact of Summer SST Anomalies on Northeastern US Eelgrass Cover</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Aaron Shavitz </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">May 3, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="introduction" class="level3">
<h3 class="anchored" data-anchor-id="introduction">Introduction</h3>
<p>Eelgrass, <em>Zostera marina</em>, is the predominant seagrass species in the U.S. and is known to provide a foundational coastal habitat in addition to numerous ecosystem services. In light of the value the species provides, significant population declines observed along the northeastern U.S. coast over the last three decades are a cause for concern. Numerous causes for the declines have been proposed and investigated, including nutrient pollution, climate change driven temperature stress, sediment disruption, and light availability.<span class="citation" data-cites="jabbari_modelling_2024">(<a href="#ref-jabbari_modelling_2024" role="doc-biblioref">Jabbari et al. 2024</a>)</span> Substantial focus has been placed on investigating the impacts of temperature stress in the northeast U.S. region due to the particularly high rates of warming in marine ecosystems <span class="citation" data-cites="plaisted_influence_2022">(<a href="#ref-plaisted_influence_2022" role="doc-biblioref">Plaisted et al. 2022</a>)</span> <span class="citation" data-cites="seidov_recent_2021">(<a href="#ref-seidov_recent_2021" role="doc-biblioref">Seidov, Mishonov, and Parsons 2021</a>)</span>. Existing studies tend to utilize in-situ water temperature measurements, such as buoy and seafloor measurements, as these are known to be the most accurate reflection of actual temperature conditions for eelgrass <span class="citation" data-cites="plaisted_influence_2022">(<a href="#ref-plaisted_influence_2022" role="doc-biblioref">Plaisted et al. 2022</a>)</span>. However given the challenges of collecting in-situ measurements over large spatial extents, there is a need to be able to utilize alternative water temperature measurements with larger spatial resolutions and extents for eelgrass studies, especially as eelgrass mapping data improves <span class="citation" data-cites="jabbari_modelling_2024">(<a href="#ref-jabbari_modelling_2024" role="doc-biblioref">Jabbari et al. 2024</a>)</span>.</p>
<p>The purpose of this study is to investigate whether SST anomalies can be used a proxy for more accurate in-situ water temperature measurements. The primary approach I take is to conduct an analysis similar to that of Plaisted et al.&nbsp;2022 <span class="citation" data-cites="plaisted_influence_2022">(<a href="#ref-plaisted_influence_2022" role="doc-biblioref">Plaisted et al. 2022</a>)</span>, in which eelgrass cover is predicted by sea surface temperature (SST) anomalies, except using satellite derived SST measurements in place of in-situ measurements. I hypothesize that summer SST anomalies one year prior to monitoring, measured via remote sensing, affect eelgrass presence and abundance on a northeastern U.S. regional scale. I attempt to test this hypothesis using a Mundlak regression approach in order to draw a causal connection between SST anomalies and eelgrass cover using observational data.</p>
</section>
<section id="methods" class="level3">
<h3 class="anchored" data-anchor-id="methods">Methods</h3>
<section id="data-sources" class="level4">
<h4 class="anchored" data-anchor-id="data-sources">Data Sources</h4>
<p>Eelgrass monitoring data for this analysis comes from SeagrassNet.org but was accessed via the data download from Plaisted et al.&nbsp;2022 <span class="citation" data-cites="plaisted_influence_2022">(<a href="#ref-plaisted_influence_2022" role="doc-biblioref">Plaisted et al. 2022</a>)</span>. The data provided by Plaisted et al.&nbsp;2022 provided additional years of monitoring data for some sites which were not yet available on SeagrassNet.org. The monitoring data used includes eelgrass percent cover measurements taken during peak growing season according to a standardized global SeagrassNet protocol <span class="citation" data-cites="plaisted_influence_2022">(<a href="#ref-plaisted_influence_2022" role="doc-biblioref">Plaisted et al. 2022</a>)</span>. Measurements are taken along 50-m transects parallel to the shoreline, each containing 12 quadrats.</p>
<p><img src="images/study_sites_plaisted_2022.png" class="img-fluid" style="width:50.0%"><br>
<em>Figure 1 - Map of the 8 northeastern U.S. SeagrassNet eelgrass monitoring sites examined in this study. Figure from <span class="citation" data-cites="plaisted_influence_2022">(<a href="#ref-plaisted_influence_2022" role="doc-biblioref">Plaisted et al. 2022</a>)</span>.</em></p>
<p>Monitoring for SeagrassNet includes multiple transects at varying depths, however for this analysis only the shallowest transects were included, as was the case for Plaisted et al.&nbsp;2022, in an attempt to standardize the depth of measurements analyzed. Inclusion of only the shallowest transects is also preferred for this analysis as SST is more likely to be representative of seafloor temperatures in shallower transects. Eight sites are included in the analysis ranging in latitude along the northeast coast of the US, from Maryland up to New Hampshire. As the collected data is non-clustered <span class="citation" data-cites="correia_designing_2025">(<a href="#ref-correia_designing_2025" role="doc-biblioref">Correia, Dee, and Ferraro 2025</a>)</span>, with only a single transect at each site, I cannot distinguish between latitude and site effects, and thus latitude effects are grouped in with site effects.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">#'--------------------------</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co">#' Eelgrass cover data from Plaisted et al. 2022: https://doi.org/10.3389/fmars.2022.920699</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co">#' Data download:</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co">#' https://datadryad.org/landing/show?id=doi%3A10.5061%2Fdryad.z34tmpggg#citations</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co">#'--------------------------</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co"># </span><span class="al">NOTE</span><span class="co"> - This data only includes the shallowest transects, to standardize depth.</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co"># This is transect "A" in all cases, except for Fire Island it is "B"</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>eelgrass_data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data/doi_10_5061_dryad_z34tmpggg__v20220628/seagrass_for_modeling.csv"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">site =</span> location)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>eelgrass_data <span class="ot">&lt;-</span> eelgrass_data <span class="sc">|&gt;</span> </span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># create centered temperature variable</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">temp_centered_prev =</span> prior_yr_mean_daily_mean_temp <span class="sc">-</span> period_avg_mean_daily_mean_temp</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>SST data for this analysis comes from the NASA Jet Propulsion Laboratory’s Multi-scale Ultra-high Resolution (MUR) Sea Surface Temperature Daily 1km East Coast EEZ data set, and was accessed via the NOAA CoastWatch ERDDAP. For each monitoring site, the most proximal square kilometer measurement was selected. The Great Bay monitoring site in NH is located within the Great Bay Estuary, which was not fully covered by the JPL SST data set. The most proximal SST measurement, at the mouth of the estuary, was used as a proxy in this analysis. Annual summer mean temperatures were calculated as the mean of all daily temperatures in the months of June, July, and August. The <strong>average mean summer SST (AMS-SST)</strong> was calculated as the mean of all daily temperatures for a given site in the months of June, July, and August across all of the “previous” years, 2002-2020.</p>
<p>The predictor of interest in this analysis is defined as the group mean-centered summer SST from the year prior to eelgrass monitoring, which is calculated as the different between the previous summer’s mean temperature at a given site-year and AMS-SST at that site for all “previous” years (2002-2020) in the study period (2003-2021). For simplicity, I will refer to this predictor as the <strong>previous summer SST anomaly (PS-SSTA)</strong> going forward.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ---</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co"># SST data previously downloaded from NOAA CoastWatch ERDDAP</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Subsetted data stored on local drive for speed of access locally</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Original SST data source:</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Sea Surface Temperature, Multi-scale Ultra-high Resolution (MUR JPL),</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Daily 1km East Coast EEZ</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="co"># June 2002 - August 2022</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="co"># https://coastwatch.noaa.gov/erddap/info/noaacwecnMURdaily/index.html</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="co"># ---</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Load each SST df, adding column for site name</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>sst_data_dh <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data/noaa_coastwatch_sst/sst_data_dh.csv"</span>)) <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">site =</span> <span class="st">"Duck Harbor Beach"</span>)</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>sst_data_fg <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data/noaa_coastwatch_sst/sst_data_fg.csv"</span>)) <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">site =</span> <span class="st">"Fort Getty"</span>)</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>sst_data_fi <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data/noaa_coastwatch_sst/sst_data_fi.csv"</span>)) <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">site =</span> <span class="st">"Fire Island"</span>)</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>sst_data_gb_proxy <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data/noaa_coastwatch_sst/sst_data_gb_proxy.csv"</span>)) <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">site =</span> <span class="st">"Great Bay"</span>)</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>sst_data_pb <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data/noaa_coastwatch_sst/sst_data_pb.csv"</span>)) <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">site =</span> <span class="st">"Pleasant Bay"</span>)</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>sst_data_pi <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data/noaa_coastwatch_sst/sst_data_pi.csv"</span>)) <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">site =</span> <span class="st">"T-Dock"</span>)</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>sst_data_ti <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data/noaa_coastwatch_sst/sst_data_ti.csv"</span>)) <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">site =</span> <span class="st">"Tingles Island"</span>)</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>sst_data_wb <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data/noaa_coastwatch_sst/sst_data_wb.csv"</span>)) <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">site =</span> <span class="st">"Salem Sound"</span>)</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Bind data vertically</span></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>sst_data <span class="ot">&lt;-</span></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>    sst_data_dh,</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>    sst_data_fg, </span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>    sst_data_fi,</span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>    sst_data_gb_proxy, </span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>    sst_data_pb, </span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>    sst_data_pi, </span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>    sst_data_ti, </span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>    sst_data_wb</span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Remove unnecessary columns (long, lat, level)</span></span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(latitude, longitude, level)) <span class="sc">|&gt;</span> </span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add columns for year and month</span></span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">year =</span> <span class="fu">year</span>(time),</span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a>         <span class="at">month =</span> <span class="fu">month</span>(time))</span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove unnecessary dfs from environment</span></span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a><span class="fu">remove</span>(<span class="at">list =</span> <span class="fu">c</span>(<span class="st">"sst_data_dh"</span>, <span class="st">"sst_data_fg"</span>, <span class="st">"sst_data_fi"</span>, <span class="st">"sst_data_gb_proxy"</span>,</span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a>                <span class="st">"sst_data_pb"</span>, <span class="st">"sst_data_pi"</span>, <span class="st">"sst_data_ti"</span>, <span class="st">"sst_data_wb"</span>))</span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a><span class="co"># # Viz all data</span></span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot(sst_data, aes(x = time, y = sst)) +</span></span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_point() +</span></span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true" tabindex="-1"></a><span class="co">#   facet_wrap(~site)</span></span>
<span id="cb2-47"><a href="#cb2-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-48"><a href="#cb2-48" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate summer mean values (June - August)</span></span>
<span id="cb2-49"><a href="#cb2-49" aria-hidden="true" tabindex="-1"></a>sst_summer_means <span class="ot">&lt;-</span> sst_data <span class="sc">|&gt;</span> </span>
<span id="cb2-50"><a href="#cb2-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(month <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb2-51"><a href="#cb2-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year, site) <span class="sc">|&gt;</span> </span>
<span id="cb2-52"><a href="#cb2-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mean_sst =</span> <span class="fu">mean</span>(sst), <span class="at">.groups =</span> <span class="st">"drop"</span>)</span>
<span id="cb2-53"><a href="#cb2-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-54"><a href="#cb2-54" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate average summer mean by site across entire time period of "previous year" (2002-2020)</span></span>
<span id="cb2-55"><a href="#cb2-55" aria-hidden="true" tabindex="-1"></a>sst_summer_average_means <span class="ot">&lt;-</span> sst_data <span class="sc">|&gt;</span> </span>
<span id="cb2-56"><a href="#cb2-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(month <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb2-57"><a href="#cb2-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">2002</span><span class="sc">:</span><span class="dv">2020</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb2-58"><a href="#cb2-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(site) <span class="sc">|&gt;</span> </span>
<span id="cb2-59"><a href="#cb2-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">average_mean_sst =</span> <span class="fu">mean</span>(sst), <span class="at">.groups =</span> <span class="st">"drop"</span>)</span>
<span id="cb2-60"><a href="#cb2-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-61"><a href="#cb2-61" aria-hidden="true" tabindex="-1"></a><span class="co"># Create df with centered mean summer temperatures</span></span>
<span id="cb2-62"><a href="#cb2-62" aria-hidden="true" tabindex="-1"></a><span class="co"># (Calculate difference between each site summer mean and site average summer mean)</span></span>
<span id="cb2-63"><a href="#cb2-63" aria-hidden="true" tabindex="-1"></a>sst_summer <span class="ot">&lt;-</span> sst_summer_means <span class="sc">|&gt;</span> </span>
<span id="cb2-64"><a href="#cb2-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(sst_summer_average_means, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"site"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb2-65"><a href="#cb2-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sst_centered =</span> mean_sst <span class="sc">-</span> average_mean_sst) <span class="sc">|&gt;</span> </span>
<span id="cb2-66"><a href="#cb2-66" aria-hidden="true" tabindex="-1"></a>  <span class="co"># create column for previous summer's centered sst</span></span>
<span id="cb2-67"><a href="#cb2-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(site, year) <span class="sc">|&gt;</span> </span>
<span id="cb2-68"><a href="#cb2-68" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(site) <span class="sc">|&gt;</span> </span>
<span id="cb2-69"><a href="#cb2-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb2-70"><a href="#cb2-70" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_sst_prev =</span> <span class="fu">lag</span>(mean_sst),</span>
<span id="cb2-71"><a href="#cb2-71" aria-hidden="true" tabindex="-1"></a>    <span class="at">sst_centered_prev =</span> <span class="fu">lag</span>(sst_centered)) <span class="sc">|&gt;</span> </span>
<span id="cb2-72"><a href="#cb2-72" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb2-73"><a href="#cb2-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-74"><a href="#cb2-74" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize</span></span>
<span id="cb2-75"><a href="#cb2-75" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot(sst_summer,</span></span>
<span id="cb2-76"><a href="#cb2-76" aria-hidden="true" tabindex="-1"></a><span class="co">#        aes(x = year, y = sst_centered, color = site)) +</span></span>
<span id="cb2-77"><a href="#cb2-77" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_line()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Prior to initiating the analysis, I wanted to understand how well the JPL SST data aligned with the temperature data used in the Plaisted et al.&nbsp;2022 study. For each site, I plotted JPL SST summer mean SST data and the calculated PS-SSTA alongside the corresponding values from buoy and transect data published by Plaisted et al.&nbsp;(Figure 2). I ran a linear regression with JPL SST as a predictor for the temperatures used by Plaisted et al., with site as a random effect, to examine correlation. The high conditional <span class="math inline">\(R^2\)</span> value of 0.873 suggested that the entire model explained the variance well, however the marginal <span class="math inline">\(R^2\)</span> of 0.537 indicated that the JPL SST did not fully explain the variance of the data used by Plaisted et al.&nbsp;This unexplained variance suggested that I might get different results from my eelgrass percent cover models compared with Plaisted et al.&nbsp;2022.</p>
<div class="columns center">
<div class="column" style="border-right: 1px solid #ccc; padding-right: 1em;">
<ol type="a">
<li></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Previous Summer mean sst</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(temp_compare_long, <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> mean_summer_sst_prev, <span class="at">color =</span> source)) <span class="sc">+</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>site) <span class="sc">+</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Year"</span>,</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Previous Summer Mean SST (°C)"</span>,</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Data Source"</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>       ) <span class="sc">+</span> </span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_discrete</span>(</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"coastwatch_mean_summer_sst_prev"</span> <span class="ot">=</span> <span class="st">"NASA JPL"</span>,</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>               <span class="st">"plaisted_mean_summer_sst_prev"</span> <span class="ot">=</span> <span class="st">"Plaisted at al. 2022"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="final_paper_files/figure-html/Plot%20Compare%20CoastWatch%20SST%20to%20Plaisted%20Temperature-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:50%;">
<ol start="2" type="a">
<li></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Previous summer centered mean sst</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(centered_temp_compare_long, <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> centered_mean_summer_sst_prev, <span class="at">color =</span> source)) <span class="sc">+</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>site) <span class="sc">+</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Year"</span>,</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Centered Previous Summer Mean SST (°C)"</span>,</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Data Source"</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_discrete</span>(</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"coastwatch_centered_sst_prev"</span> <span class="ot">=</span> <span class="st">"NASA JPL"</span>,</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>               <span class="st">"plaisted_centered_sst_prev"</span> <span class="ot">=</span> <span class="st">"Plaisted at al. 2022"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="final_paper_files/figure-html/Plot%20Compare%20Anomalies%20CoastWatch%20SST%20to%20Plaisted%20Temperature-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># After observing that the satellite SSTs were consistently lower than in situ measurements</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="co"># except at Salem Sound, I reported this discrepency to Mass Bays, who informed me that the </span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co"># shallowest transect depth at Salem South is significantly deeper than at other sites. </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p><em>Figure 2 - a) NASA Jet Propulsion Lab SST satellite measurements during the study period plotted alongside in-situ (bouy and seafloor transect) temperature measurements used by <span class="citation" data-cites="plaisted_influence_2022">(<a href="#ref-plaisted_influence_2022" role="doc-biblioref">Plaisted et al. 2022</a>)</span>. b) SST Anomalies calculated from NASA Jet Propulsion Lab SST during the study period plotted alongside SST anomalies from in-situ temperature measurements used by <span class="citation" data-cites="plaisted_influence_2022">(<a href="#ref-plaisted_influence_2022" role="doc-biblioref">Plaisted et al. 2022</a>)</span>.</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Include site as a random effect</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>temp_compare_glmm <span class="ot">&lt;-</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glmmTMB</span>(coastwatch_mean_summer_sst_prev <span class="sc">~</span> plaisted_mean_summer_sst_prev <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> site),</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">data =</span> temp_compare)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Check assumptions</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="fu">check_model</span>(temp_compare_glmm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generally look good</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary info</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(temp_compare_glmm)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="fu">r2</span>(temp_compare_glmm)</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="co"># The conditional R2 is near 1, so the entire model explains the variance well,</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="co"># but the conditional R2 is smaller, so CoastWatch mean summer sst doesn't fully</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="co"># explain the variance of the mean summer sst values used in the Plaisted paper.</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="co"># This suggests to me that we may get different results from our model compared to theirs.</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="fu">visreg</span>(temp_compare_glmm, <span class="st">"plaisted_mean_summer_sst_prev"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="study-design" class="level4">
<h4 class="anchored" data-anchor-id="study-design">Study Design</h4>
<p>The primary goal of this project was to investigate whether causal relationship can be drawn between SST anomalies and the success of eelgrass. The typical approach in the field of ecology for designing causal studies is the randomized control trial, in which subjects are randomly assigned to treatment or control groups, and confounding variables can be held constant. <span class="citation" data-cites="larsen_causal_2019">(<a href="#ref-larsen_causal_2019" role="doc-biblioref">Larsen, Meng, and Kendall 2019</a>)</span> The use of previously collected observational data, as is the case in this analysis, thus poses challenges to creating a causal study design, notably because confounders can be difficult to account for.</p>
<p>To attempt to design a causal analysis with existing observational, I applied the Mundlak regression approach which uses group-averaged predictors at the site level to attempt to pull out the impact of unmeasured site-level confounding variables <span class="citation" data-cites="correia_designing_2025">(<a href="#ref-correia_designing_2025" role="doc-biblioref">Correia, Dee, and Ferraro 2025</a>)</span>. In the context of my analysis, the predictor of interest is the PS-SSTA, and the AMS-SST for each site is included as an additional predictor to account for unmeasured site-level drivers correlated with summer SST and eelgrass cover <span class="citation" data-cites="suskiewicz_ocean_2024">(<a href="#ref-suskiewicz_ocean_2024" role="doc-biblioref">Suskiewicz et al. 2024</a>)</span>. The ability of including this site-level group-averaged predictor to break confounding can be demonstrated using directed acyclic graphs (DAGs) of the study design. In Figure 3 below, PS-SSTA is made exogenous because the AMS-SST accounts for confounding.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the DAG</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(eelgrass_dag_final_tidy,</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y,</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">xend =</span> xend, <span class="at">yend =</span> yend)) <span class="sc">+</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dag_node</span>(<span class="at">shape =</span> <span class="dv">5</span>, <span class="at">size =</span> <span class="dv">25</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dag_text</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dag_edges</span>(</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> xstart, <span class="at">y =</span> ystart),</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">edge_width =</span> <span class="fl">1.2</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.5</span>, <span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_dag_blank</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="final_paper_files/figure-html/Full%20Final%20DAG-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><em>Figure 3 - Directed Acyclic Graph (DAG) of study design. Following a Mundlak regression approach, summer SST anomaly is made exogenous via the inclusion of site-level average mean summer SST.</em></p>
</section>
<section id="statistical-analysis-aggregated-percent-cover-model" class="level4">
<h4 class="anchored" data-anchor-id="statistical-analysis-aggregated-percent-cover-model">Statistical Analysis: Aggregated Percent Cover Model</h4>
<p>The impact of PS-SSTA on eelgrass cover was first examined by using percent cover aggregated at the site-transect level. Percent cover was aggregated by calculating a simple mean of all quadrat percent cover values measured in a given site-year. The purpose of aggregating percent cover was to eliminate potential spatial autocorrelation between quadrat level measurement, as well as to reduce the number of 0% values that would need to be accounted for in the model. This approach differed from Plaisted et al.&nbsp;2022, who conducted their analyses at the quadrat level, using a hurdle model design to predict probability of presence prior to percent cover <span class="citation" data-cites="plaisted_influence_2022">(<a href="#ref-plaisted_influence_2022" role="doc-biblioref">Plaisted et al. 2022</a>)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Reorganize and remove unnecessary variables</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>eelgrass_data <span class="ot">&lt;-</span> eelgrass_data <span class="sc">|&gt;</span> </span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">c</span>(year, site, quadrat, percent_cover)) <span class="sc">|&gt;</span> </span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(site)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Prepare data for Aggregated Percent Cover Model</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Aggregate (average) at the site level in order to avoid requiring inclusion of </span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="co"># quadrat random effects, and to reduce 0 and 1 values for binomial regression.</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Also, My predictor is annual site level (temp), so my outcome (percent cover) will be the same.</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>eelgrass_data_aggregated <span class="ot">&lt;-</span> eelgrass_data <span class="sc">|&gt;</span> </span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(site, year) <span class="sc">|&gt;</span> </span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">percent_cover =</span> <span class="fu">mean</span>(percent_cover) <span class="sc">/</span> <span class="dv">100</span>, <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Join sst and aggregated percent cover data</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(sst_summer, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"site"</span>, <span class="st">"year"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># If the average percent cover is 100%, convert to 99% because there is no meaningful ecological</span></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># difference, and it allows beta regression to work</span></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">percent_cover =</span> <span class="fu">ifelse</span>(percent_cover <span class="sc">==</span> <span class="dv">1</span>, <span class="fl">0.99</span>, percent_cover))</span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a><span class="do">## Prepare data for Presence Absence Model</span></span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a><span class="co"># For the presence absence model, I will not aggregate at the site level, and will include </span></span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a><span class="co"># quadrat level random effects</span></span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Join sst data to eelgrass_data</span></span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a>eelgrass_data <span class="ot">&lt;-</span> eelgrass_data <span class="sc">|&gt;</span> </span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(sst_summer, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"site"</span>, <span class="st">"year"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a>    <span class="co"># create column for presence absence (1 = presence, 0 = absence)</span></span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">presence =</span> <span class="fu">ifelse</span>(percent_cover <span class="sc">==</span> <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a>    <span class="co"># create nested ID for site_quadrat for random effects inclusion</span></span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">site_quadrat =</span> <span class="fu">paste0</span>(site, <span class="st">"_"</span>, quadrat)</span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span> </span>
<span id="cb9-35"><a href="#cb9-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(presence, <span class="at">.after =</span> percent_cover) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>I evaluated aggregated percent cover using a generalized linear mixed model (GLMM) with the glmmTMB package in R. For eelgrass percent cover, I fit a beta regression with a logit link, which is a typical approach for bounded data such as percent cover. Predictors were the PS-SSTA and the AMS-SST as described in the Mundlak regression approach. Random intercepts for year and site were included, and a random slope was also included for site on the assumption that SST anomalies may affect eelgrass cover differently at each site. Aggregating at the transect level did not eliminate all zero values, so I included a zero-inflation component in the model to account for remaining zero values.</p>
<pre><code>eelgrass_pc_glmm &lt;- glmmTMB(
  percent_cover ~ PS_SSTA + AMS_SST + (1 + PS_SSTA | Site) + (1 | Year),
  family = beta_family(link = "logit"),
  ziformula = ~1,
  data = eelgrass_data_aggregated)</code></pre>
<p>Model validity was considered valid on the premise that the study is interested in the impact of water temperature, and SST anomalies can serve as a proxy for bottom water anomalies in shallow areas. Regarding representativeness, our sample data only represents a subset of the population of the most shallow growing eelgrass on the eastern U.S. coast, and thus interpretations of the results are only considered for this population. For GLMMs, the endogeneity assumption is predominantly argued based on theory, and thus the model system DAG provides evidence for passing of this model assumption. It is possible that SST anomalies are correlated with other factors which impact eelgrass cover, such as major storm events. However, for this analysis I assume the majority of factors influencing eelgrass cover would not be correlated with SST anomalies, such as boating/fishing activity, and the inclusion of year as a random effect attempts to account for major coastline events such as storms.</p>
<p>Remaining model assumptions and residuals were evaluated using the DHARMa and performance packages in R. No overdispersion or overly influential outliers were identified, and the Kolmogorov-Smirnov test indicates the error distribution (scaled residuals) was relatively uniformly distributed, although with some deviation. Random effects were normally distributed and a posterior predictive check indicated that model-predicted data was relatively aligned with the observed data. Additivity was checked by refitting the model with interaction between the two predictors included and testing whether the model fit was significantly improved using an Akaike Information Criterion (AIC) comparison and a likelihood ratio test (anova, test=”Chisq”). Including the interaction term did not improve model fit, so the additivity assumption was considered to be met.</p>
<p>The main assumption violation that arose in model checks was the review of DHARMa residuals vs.&nbsp;model predictions, which indicated the residual distribution was not constant, i.e.&nbsp;homoscedasticity was not met, despite the scaled residuals being relatively uniformly distributed overall according to the KS test. Failure of the homoscedasticity assumption is likely explained by the model failing the linearity assumption, and possibly the independence of errors (whether all replicates truly independent) assumption due to the fact that there may be temporal autocorrelation between percent cover measurements taken in consecutive years. In order to relax the linearity assumption and allow for nonlinear effects, I fit additional models with natural spline transformations on the PS-SSTA predictor, with degrees of freedom from 2 through 5, and compared their fits via AIC comparison. Each of the spline models fit the data better than the original linear model, although only the model with 3 degrees of freedom showed relatively constant residual distribution, so this model was used for analysis alongside the original linear model. The spline model passed all other assumptions, and did not invalidate my hypothesis as I only predicted SST anomalies would affect eelgrass cover, without specifying a specific relationship. The original linear model was kept for interpretability of the results, despite failing the homoscedasticity, linearity, and independence of errors assumptions.</p>
<pre><code>eelgrass_pc_glmm &lt;- glmmTMB(
  percent_cover ~ splines::ns(PS_SSTA, df = 3) + AMS_SST + (1 + PS_SSTA | Site) + (1 | Year),
  family = beta_family(link = "logit"),
  ziformula = ~1,
  data = eelgrass_data_aggregated)</code></pre>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Build Model to predict aggregated percent cover:</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="co"># - Outcome is percent cover </span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="co"># - Predictors are:</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co">#   - Centered mean summer sst from the previous year (anomaly)</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="co">#   - Site level mean Summer SST for the study period</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="co"># - Beta error distribution because % cover data</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="co"># - Logit link because working with percentages bounded between 0 &amp; 1</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="co"># - There are zero values, need to account for zero inflation</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a><span class="co"># - Random effects:</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a><span class="co">#   - Site - random intercept and slope, as SST anomaly relationship may differ by site </span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a><span class="co">#   - Year - random intercept, as certain years (e.g. those with major weather events) may</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a><span class="co">#     have different intercept</span></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Mundlak Regression Approach</span></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>eelgrass_pc_glmm <span class="ot">&lt;-</span> <span class="fu">glmmTMB</span>(</span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>  percent_cover <span class="sc">~</span> sst_centered_prev <span class="sc">+</span> average_mean_sst <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> sst_centered_prev <span class="sc">|</span> site) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> year),</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">beta_family</span>(<span class="at">link =</span> <span class="st">"logit"</span>),</span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">ziformula =</span> <span class="sc">~</span><span class="dv">1</span>,</span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> eelgrass_data_aggregated)</span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a><span class="co"># DHARMa residuals test</span></span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a><span class="fu">simulateResiduals</span>(eelgrass_pc_glmm, <span class="at">plot =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="final_paper_files/figure-html/Aggregated%20Percent%20Cover%20Model-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Object of Class DHARMa with simulated residuals based on 250 simulations with refit = FALSE . See ?DHARMa::simulateResiduals for help. 
 
Scaled residual values: 0.888 0.888 0.828 0.82 0.804 0.576 0.656 0.34 0.592 0.62 0.5 0.156 0.136 0.128 0.1242816 0.136 0.0614357 0.1409842 0.404 0.188 ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Model fails linearity, based on DHARMa residuals</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Attempt to add splines with varying dfs to find best fitting non-linear model at lowest cost</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>eelgrass_pc_glmm_2 <span class="ot">&lt;-</span> <span class="fu">glmmTMB</span>(</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  percent_cover <span class="sc">~</span> splines<span class="sc">::</span><span class="fu">ns</span>(sst_centered_prev, <span class="at">df =</span> <span class="dv">2</span>) <span class="sc">+</span> average_mean_sst <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> sst_centered_prev <span class="sc">|</span> site) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> year),</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">beta_family</span>(<span class="at">link =</span> <span class="st">"logit"</span>),</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">ziformula =</span> <span class="sc">~</span><span class="dv">1</span>,</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> eelgrass_data_aggregated)</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>eelgrass_pc_glmm_3 <span class="ot">&lt;-</span> <span class="fu">glmmTMB</span>(</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>  percent_cover <span class="sc">~</span> splines<span class="sc">::</span><span class="fu">ns</span>(sst_centered_prev, <span class="at">df =</span> <span class="dv">3</span>) <span class="sc">+</span> average_mean_sst <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> sst_centered_prev <span class="sc">|</span> site) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> year),</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">beta_family</span>(<span class="at">link =</span> <span class="st">"logit"</span>),</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">ziformula =</span> <span class="sc">~</span><span class="dv">1</span>,</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> eelgrass_data_aggregated)</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>eelgrass_pc_glmm_4 <span class="ot">&lt;-</span> <span class="fu">glmmTMB</span>(</span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>  percent_cover <span class="sc">~</span> splines<span class="sc">::</span><span class="fu">ns</span>(sst_centered_prev, <span class="at">df =</span> <span class="dv">4</span>) <span class="sc">+</span> average_mean_sst <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> sst_centered_prev <span class="sc">|</span> site) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> year),</span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">beta_family</span>(<span class="at">link =</span> <span class="st">"logit"</span>),</span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">ziformula =</span> <span class="sc">~</span><span class="dv">1</span>,</span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> eelgrass_data_aggregated)</span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a>eelgrass_pc_glmm_5 <span class="ot">&lt;-</span> <span class="fu">glmmTMB</span>(</span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a>  percent_cover <span class="sc">~</span> splines<span class="sc">::</span><span class="fu">ns</span>(sst_centered_prev, <span class="at">df =</span> <span class="dv">5</span>) <span class="sc">+</span> average_mean_sst <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> sst_centered_prev <span class="sc">|</span> site) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> year),</span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">beta_family</span>(<span class="at">link =</span> <span class="st">"logit"</span>),</span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">ziformula =</span> <span class="sc">~</span><span class="dv">1</span>,</span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> eelgrass_data_aggregated)</span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Check AIC</span></span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(eelgrass_pc_glmm,</span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a>    eelgrass_pc_glmm_2,</span>
<span id="cb14-30"><a href="#cb14-30" aria-hidden="true" tabindex="-1"></a>    eelgrass_pc_glmm_3, </span>
<span id="cb14-31"><a href="#cb14-31" aria-hidden="true" tabindex="-1"></a>    eelgrass_pc_glmm_4, </span>
<span id="cb14-32"><a href="#cb14-32" aria-hidden="true" tabindex="-1"></a>    eelgrass_pc_glmm_5)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                   df      AIC
eelgrass_pc_glmm    9 58.20791
eelgrass_pc_glmm_2 10 47.93398
eelgrass_pc_glmm_3 11 47.51994
eelgrass_pc_glmm_4 12 48.01618
eelgrass_pc_glmm_5 13 50.04964</code></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Lowest AIC for df = 2, however no functional difference between df = 2, 3, or 4, and</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="co"># df = 3 appears to pass the DHARMa residuals check</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="fu">simulateResiduals</span>(eelgrass_pc_glmm_3, <span class="at">plot =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="final_paper_files/figure-html/Aggregated%20Percent%20Cover%20Model-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Object of Class DHARMa with simulated residuals based on 250 simulations with refit = FALSE . See ?DHARMa::simulateResiduals for help. 
 
Scaled residual values: 0.828 0.672 0.496 0.76 0.868 0.676 0.636 0.44 0.548 0.648 0.36 0.168 0.172 0.136 0.03316039 0.168 0.1199968 0.0639891 0.456 0.244 ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Thus: Use eelgrass_pc_glmm for linear model, and eelgrass_pc_glmm_3 for non-linear model</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">check_model</span>(eelgrass_pc_glmm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="final_paper_files/figure-html/Check%20Assumptions%20-%20Aggregated%20Percent%20Cover%20Model-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">check_model</span>(eelgrass_pc_glmm_3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="final_paper_files/figure-html/Check%20Assumptions%20-%20Aggregated%20Percent%20Cover%20Model-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Validity - Do X and Y Reflect Concepts I'm interested In</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="co"># - Conceptual check</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="co">#   - Yes, we are interested in water temperature, and sst anomalies can serve as a proxy for</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="co">#     bottom water anomalies in shallow areas where eelgrass grows.</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Representativeness: Does Your Data Represent the Population?</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="co"># - Conceptual check </span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a><span class="co">#   - Our sample we are working with only represents the population of the most shallow growing </span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a><span class="co">#     eelgrass on the Eastern US. Variety of different mean temps.</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Model captures features in the data</span></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a><span class="co"># - Posterior predictive check</span></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a><span class="fu">check_predictions</span>(eelgrass_pc_glmm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="final_paper_files/figure-html/Check%20Assumptions%20-%20Aggregated%20Percent%20Cover%20Model-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">check_predictions</span>(eelgrass_pc_glmm_3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="final_paper_files/figure-html/Check%20Assumptions%20-%20Aggregated%20Percent%20Cover%20Model-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Both look good</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Linearity</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="co"># - Assuming linearity between the predictor and the log-odds (for binomial) </span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="co">#   or logit-transformed mean (for beta regression)</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="co"># - Simulate residuals</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a><span class="fu">simulateResiduals</span>(eelgrass_pc_glmm, <span class="at">plot =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="final_paper_files/figure-html/Check%20Assumptions%20-%20Aggregated%20Percent%20Cover%20Model-5.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Object of Class DHARMa with simulated residuals based on 250 simulations with refit = FALSE . See ?DHARMa::simulateResiduals for help. 
 
Scaled residual values: 0.888 0.888 0.828 0.82 0.804 0.576 0.656 0.34 0.592 0.62 0.5 0.156 0.136 0.128 0.1242816 0.136 0.0614357 0.1409842 0.404 0.188 ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">simulateResiduals</span>(eelgrass_pc_glmm_3, <span class="at">plot =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="final_paper_files/figure-html/Check%20Assumptions%20-%20Aggregated%20Percent%20Cover%20Model-6.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Object of Class DHARMa with simulated residuals based on 250 simulations with refit = FALSE . See ?DHARMa::simulateResiduals for help. 
 
Scaled residual values: 0.828 0.672 0.496 0.76 0.868 0.676 0.636 0.44 0.548 0.648 0.36 0.168 0.172 0.136 0.03316039 0.168 0.1199968 0.0639891 0.456 0.244 ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># - Relationship is likely NON linear</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Additivity</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="co"># - Assumption that fixed effects impact is additive - they don't affect each other</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a><span class="co">#   - Include interaction in the model(s), and see if it improves anything</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>eelgrass_pc_glmm_int <span class="ot">&lt;-</span> <span class="fu">glmmTMB</span>(</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>  percent_cover <span class="sc">~</span> sst_centered_prev <span class="sc">*</span> average_mean_sst <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> sst_centered_prev <span class="sc">|</span> site) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> year),</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">beta_family</span>(<span class="at">link =</span> <span class="st">"logit"</span>),</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">ziformula =</span> <span class="sc">~</span><span class="dv">1</span>,</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> eelgrass_data_aggregated)</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>eelgrass_pc_glmm_3_int <span class="ot">&lt;-</span> <span class="fu">glmmTMB</span>(</span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>  percent_cover <span class="sc">~</span> splines<span class="sc">::</span><span class="fu">ns</span>(sst_centered_prev, <span class="at">df =</span> <span class="dv">3</span>) <span class="sc">*</span> average_mean_sst <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> sst_centered_prev <span class="sc">|</span> site) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> year),</span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">beta_family</span>(<span class="at">link =</span> <span class="st">"logit"</span>),</span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">ziformula =</span> <span class="sc">~</span><span class="dv">1</span>,</span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> eelgrass_data_aggregated)</span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a><span class="fu">check_model</span>(eelgrass_pc_glmm_int)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="final_paper_files/figure-html/Check%20Assumptions%20-%20Aggregated%20Percent%20Cover%20Model-7.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">check_model</span>(eelgrass_pc_glmm_3_int)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="final_paper_files/figure-html/Check%20Assumptions%20-%20Aggregated%20Percent%20Cover%20Model-8.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">simulateResiduals</span>(eelgrass_pc_glmm_int, <span class="at">plot =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="final_paper_files/figure-html/Check%20Assumptions%20-%20Aggregated%20Percent%20Cover%20Model-9.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Object of Class DHARMa with simulated residuals based on 250 simulations with refit = FALSE . See ?DHARMa::simulateResiduals for help. 
 
Scaled residual values: 0.852 0.888 0.836 0.832 0.78 0.648 0.672 0.396 0.568 0.624 0.42 0.148 0.168 0.132 0.007430157 0.2 0.0154407 0.1141761 0.392 0.248 ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">simulateResiduals</span>(eelgrass_pc_glmm_3_int, <span class="at">plot =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="final_paper_files/figure-html/Check%20Assumptions%20-%20Aggregated%20Percent%20Cover%20Model-10.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Object of Class DHARMa with simulated residuals based on 250 simulations with refit = FALSE . See ?DHARMa::simulateResiduals for help. 
 
Scaled residual values: 0.82 0.716 0.512 0.78 0.86 0.656 0.652 0.408 0.508 0.58 0.332 0.156 0.156 0.224 0.09572314 0.204 0.01902365 0.1250032 0.348 0.252 ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Also can compare models directly</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(eelgrass_pc_glmm, eelgrass_pc_glmm_int, <span class="at">test =</span> <span class="st">"Chisq"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Data: eelgrass_data_aggregated
Models:
eelgrass_pc_glmm: percent_cover ~ sst_centered_prev + average_mean_sst + (1 + sst_centered_prev | , zi=~1, disp=~1
eelgrass_pc_glmm:     site) + (1 | year), zi=~1, disp=~1
eelgrass_pc_glmm_int: percent_cover ~ sst_centered_prev * average_mean_sst + (1 + sst_centered_prev | , zi=~1, disp=~1
eelgrass_pc_glmm_int:     site) + (1 | year), zi=~1, disp=~1
                     Df    AIC   BIC  logLik deviance  Chisq Chi Df Pr(&gt;Chisq)
eelgrass_pc_glmm      9 58.208 82.43 -20.104   40.208                         
eelgrass_pc_glmm_int 10 60.136 87.05 -20.068   40.136 0.0718      1     0.7887</code></pre>
</div>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(eelgrass_pc_glmm_3, eelgrass_pc_glmm_3_int, <span class="at">test =</span> <span class="st">"Chisq"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Data: eelgrass_data_aggregated
Models:
eelgrass_pc_glmm_3: percent_cover ~ splines::ns(sst_centered_prev, df = 3) + average_mean_sst + , zi=~1, disp=~1
eelgrass_pc_glmm_3:     (1 + sst_centered_prev | site) + (1 | year), zi=~1, disp=~1
eelgrass_pc_glmm_3_int: percent_cover ~ splines::ns(sst_centered_prev, df = 3) * average_mean_sst + , zi=~1, disp=~1
eelgrass_pc_glmm_3_int:     (1 + sst_centered_prev | site) + (1 | year), zi=~1, disp=~1
                       Df    AIC    BIC  logLik deviance  Chisq Chi Df
eelgrass_pc_glmm_3     11 47.520 77.125 -12.760   25.520              
eelgrass_pc_glmm_3_int 14 50.602 88.281 -11.301   22.602 2.9183      3
                       Pr(&gt;Chisq)
eelgrass_pc_glmm_3               
eelgrass_pc_glmm_3_int     0.4044</code></pre>
</div>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check AICs to see if including interaction fits data better</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(eelgrass_pc_glmm, eelgrass_pc_glmm_int)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                     df      AIC
eelgrass_pc_glmm      9 58.20791
eelgrass_pc_glmm_int 10 60.13611</code></pre>
</div>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(eelgrass_pc_glmm_3, eelgrass_pc_glmm_3_int)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                       df      AIC
eelgrass_pc_glmm_3     11 47.51994
eelgrass_pc_glmm_3_int 14 50.60169</code></pre>
</div>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Additivity assumption seems okay - including interaction does not improve model</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Independence of errors</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a><span class="co"># - Are all replicates truly independent?</span></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a><span class="co">#   - Look at fitted values vs residuals</span></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a><span class="fu">simulateResiduals</span>(eelgrass_pc_glmm, <span class="at">plot =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="final_paper_files/figure-html/Check%20Assumptions%20-%20Aggregated%20Percent%20Cover%20Model-11.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Object of Class DHARMa with simulated residuals based on 250 simulations with refit = FALSE . See ?DHARMa::simulateResiduals for help. 
 
Scaled residual values: 0.888 0.888 0.828 0.82 0.804 0.576 0.656 0.34 0.592 0.62 0.5 0.156 0.136 0.128 0.1242816 0.136 0.0614357 0.1409842 0.404 0.188 ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">testResiduals</span>(eelgrass_pc_glmm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="final_paper_files/figure-html/Check%20Assumptions%20-%20Aggregated%20Percent%20Cover%20Model-12.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>$uniformity

    Asymptotic one-sample Kolmogorov-Smirnov test

data:  simulationOutput$scaledResiduals
D = 0.1295, p-value = 0.05166
alternative hypothesis: two-sided


$dispersion

    DHARMa nonparametric dispersion test via sd of residuals fitted vs.
    simulated

data:  simulationOutput
dispersion = 0.89066, p-value = 0.512
alternative hypothesis: two.sided


$outliers

    DHARMa outlier test based on exact binomial test with approximate
    expectations

data:  simulationOutput
outliers at both margin(s) = 0, observations = 109, p-value = 1
alternative hypothesis: true probability of success is not equal to 0.007968127
95 percent confidence interval:
 0.00000000 0.03327666
sample estimates:
frequency of outliers (expected: 0.00796812749003984 ) 
                                                     0 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">simulateResiduals</span>(eelgrass_pc_glmm_3, <span class="at">plot =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="final_paper_files/figure-html/Check%20Assumptions%20-%20Aggregated%20Percent%20Cover%20Model-13.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Object of Class DHARMa with simulated residuals based on 250 simulations with refit = FALSE . See ?DHARMa::simulateResiduals for help. 
 
Scaled residual values: 0.828 0.672 0.496 0.76 0.868 0.676 0.636 0.44 0.548 0.648 0.36 0.168 0.172 0.136 0.03316039 0.168 0.1199968 0.0639891 0.456 0.244 ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">testResiduals</span>(eelgrass_pc_glmm_3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="final_paper_files/figure-html/Check%20Assumptions%20-%20Aggregated%20Percent%20Cover%20Model-14.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>$uniformity

    Asymptotic one-sample Kolmogorov-Smirnov test

data:  simulationOutput$scaledResiduals
D = 0.063853, p-value = 0.7658
alternative hypothesis: two-sided


$dispersion

    DHARMa nonparametric dispersion test via sd of residuals fitted vs.
    simulated

data:  simulationOutput
dispersion = 0.90681, p-value = 0.544
alternative hypothesis: two.sided


$outliers

    DHARMa outlier test based on exact binomial test with approximate
    expectations

data:  simulationOutput
outliers at both margin(s) = 2, observations = 109, p-value = 0.2158
alternative hypothesis: true probability of success is not equal to 0.007968127
95 percent confidence interval:
 0.002229879 0.064711856
sample estimates:
frequency of outliers (expected: 0.00796812749003984 ) 
                                            0.01834862 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co">#   - Fails for linear model, okay for spline model</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="co">#   - Logically samples will be correlated year to year, within site, </span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a><span class="co">#     and between neighboring quadrats. Aggregating at the site level to deal with quadrat</span></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a><span class="co">#     autocorrelation takes care of that. </span></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a><span class="co">#   - Inclusion of random effects for year and site attempts to handle how different years </span></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a><span class="co">#     and sites behave, but I suspect temporal autocorrelation is still an issue.</span></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Homoscedasticity of the errors (constant variance AKA homogeneity of variance)</span></span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a><span class="co"># - Plot fitted values vs sqrt of sd of residuals</span></span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a><span class="co"># - But this is more for guassian dist. This is relaxed for non-gaussian dist.</span></span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a><span class="co"># - Look at quantile residuals</span></span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a><span class="co"># check_model(eelgrass_pc_glmm, check = c("homogeneity"))</span></span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a><span class="co"># check_model(eelgrass_pc_glmm_3, check = c("homogeneity"))</span></span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Clear curvature in fitted values vs sqrt of sd of residuals plot. But for non-gaussian </span></span>
<span id="cb49-15"><a href="#cb49-15" aria-hidden="true" tabindex="-1"></a><span class="co"># we should actually check residuals QQ plot</span></span>
<span id="cb49-16"><a href="#cb49-16" aria-hidden="true" tabindex="-1"></a><span class="fu">simulateResiduals</span>(eelgrass_pc_glmm, <span class="at">plot =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="final_paper_files/figure-html/Check%20Assumptions%20-%20Aggregated%20Percent%20Cover%20Model-15.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Object of Class DHARMa with simulated residuals based on 250 simulations with refit = FALSE . See ?DHARMa::simulateResiduals for help. 
 
Scaled residual values: 0.888 0.888 0.828 0.82 0.804 0.576 0.656 0.34 0.592 0.62 0.5 0.156 0.136 0.128 0.1242816 0.136 0.0614357 0.1409842 0.404 0.188 ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">simulateResiduals</span>(eelgrass_pc_glmm_3, <span class="at">plot =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="final_paper_files/figure-html/Check%20Assumptions%20-%20Aggregated%20Percent%20Cover%20Model-16.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Object of Class DHARMa with simulated residuals based on 250 simulations with refit = FALSE . See ?DHARMa::simulateResiduals for help. 
 
Scaled residual values: 0.828 0.672 0.496 0.76 0.868 0.676 0.636 0.44 0.548 0.648 0.36 0.168 0.172 0.136 0.03316039 0.168 0.1199968 0.0639891 0.456 0.244 ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">check_model</span>(eelgrass_pc_glmm, <span class="at">check =</span> <span class="fu">c</span>(<span class="st">"qq"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="final_paper_files/figure-html/Check%20Assumptions%20-%20Aggregated%20Percent%20Cover%20Model-17.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">check_model</span>(eelgrass_pc_glmm_3, <span class="at">check =</span> <span class="fu">c</span>(<span class="st">"qq"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="final_paper_files/figure-html/Check%20Assumptions%20-%20Aggregated%20Percent%20Cover%20Model-18.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fails for linear model, but looks okay for non-linear model. Likely due to non-linear relationship</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Overdispersion</span></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a><span class="co"># - Is observed variance higher than the variance of the theoretical model?</span></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a><span class="fu">simulateResiduals</span>(eelgrass_pc_glmm, <span class="at">plot =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="final_paper_files/figure-html/Check%20Assumptions%20-%20Aggregated%20Percent%20Cover%20Model-19.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Object of Class DHARMa with simulated residuals based on 250 simulations with refit = FALSE . See ?DHARMa::simulateResiduals for help. 
 
Scaled residual values: 0.888 0.888 0.828 0.82 0.804 0.576 0.656 0.34 0.592 0.62 0.5 0.156 0.136 0.128 0.1242816 0.136 0.0614357 0.1409842 0.404 0.188 ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">simulateResiduals</span>(eelgrass_pc_glmm_3, <span class="at">plot =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="final_paper_files/figure-html/Check%20Assumptions%20-%20Aggregated%20Percent%20Cover%20Model-20.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Object of Class DHARMa with simulated residuals based on 250 simulations with refit = FALSE . See ?DHARMa::simulateResiduals for help. 
 
Scaled residual values: 0.828 0.672 0.496 0.76 0.868 0.676 0.636 0.44 0.548 0.648 0.36 0.168 0.172 0.136 0.03316039 0.168 0.1199968 0.0639891 0.456 0.244 ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">testDispersion</span>(eelgrass_pc_glmm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="final_paper_files/figure-html/Check%20Assumptions%20-%20Aggregated%20Percent%20Cover%20Model-21.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    DHARMa nonparametric dispersion test via sd of residuals fitted vs.
    simulated

data:  simulationOutput
dispersion = 0.89066, p-value = 0.512
alternative hypothesis: two.sided</code></pre>
</div>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">testDispersion</span>(eelgrass_pc_glmm_3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="final_paper_files/figure-html/Check%20Assumptions%20-%20Aggregated%20Percent%20Cover%20Model-22.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    DHARMa nonparametric dispersion test via sd of residuals fitted vs.
    simulated

data:  simulationOutput
dispersion = 0.90681, p-value = 0.544
alternative hypothesis: two.sided</code></pre>
</div>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Looks good for both models</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Endogeneity - Predictor is not correlated with the error term</span></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a><span class="co"># - For glmm, this is predominantly argued logically, based on theory/DAG</span></span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a><span class="co">#   - This may not pass, because SST anomaly could be correlated with storm events </span></span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a><span class="co">#     (e.g. mixing impacting SST and eelgrass), turbidity from chlorophyll, and other error. </span></span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a><span class="co">#     But generally, we assume the majority of factors influencing eelgrass cover would not</span></span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a><span class="co">#     be correlated with SST anomaly, such as boating/fishing activity...? Including year as </span></span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a><span class="co">#     random effect also helps account for storm events. </span></span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Check error distribution</span></span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a><span class="co"># - Don't assume normality of error distribution for GLMMs</span></span>
<span id="cb63-13"><a href="#cb63-13" aria-hidden="true" tabindex="-1"></a><span class="co"># - Instead, assume uniformity of scaled residuals - See DHARMa KS test </span></span>
<span id="cb63-14"><a href="#cb63-14" aria-hidden="true" tabindex="-1"></a><span class="fu">simulateResiduals</span>(eelgrass_pc_glmm, <span class="at">plot =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="final_paper_files/figure-html/Check%20Assumptions%20-%20Aggregated%20Percent%20Cover%20Model-23.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Object of Class DHARMa with simulated residuals based on 250 simulations with refit = FALSE . See ?DHARMa::simulateResiduals for help. 
 
Scaled residual values: 0.888 0.888 0.828 0.82 0.804 0.576 0.656 0.34 0.592 0.62 0.5 0.156 0.136 0.128 0.1242816 0.136 0.0614357 0.1409842 0.404 0.188 ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">simulateResiduals</span>(eelgrass_pc_glmm_3, <span class="at">plot =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="final_paper_files/figure-html/Check%20Assumptions%20-%20Aggregated%20Percent%20Cover%20Model-24.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Object of Class DHARMa with simulated residuals based on 250 simulations with refit = FALSE . See ?DHARMa::simulateResiduals for help. 
 
Scaled residual values: 0.828 0.672 0.496 0.76 0.868 0.676 0.636 0.44 0.548 0.648 0.36 0.168 0.172 0.136 0.03316039 0.168 0.1199968 0.0639891 0.456 0.244 ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Looks good for both models</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Normality of random effects</span></span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a><span class="fu">check_model</span>(eelgrass_pc_glmm, <span class="at">check =</span> <span class="fu">c</span>(<span class="st">"reqq"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="final_paper_files/figure-html/Check%20Assumptions%20-%20Aggregated%20Percent%20Cover%20Model-25.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">check_model</span>(eelgrass_pc_glmm_3, <span class="at">check =</span> <span class="fu">c</span>(<span class="st">"reqq"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="final_paper_files/figure-html/Check%20Assumptions%20-%20Aggregated%20Percent%20Cover%20Model-26.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co"># looks good</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Minimal outlier influence</span></span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a><span class="fu">simulateResiduals</span>(eelgrass_pc_glmm, <span class="at">plot =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="final_paper_files/figure-html/Check%20Assumptions%20-%20Aggregated%20Percent%20Cover%20Model-27.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Object of Class DHARMa with simulated residuals based on 250 simulations with refit = FALSE . See ?DHARMa::simulateResiduals for help. 
 
Scaled residual values: 0.888 0.888 0.828 0.82 0.804 0.576 0.656 0.34 0.592 0.62 0.5 0.156 0.136 0.128 0.1242816 0.136 0.0614357 0.1409842 0.404 0.188 ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">simulateResiduals</span>(eelgrass_pc_glmm_3, <span class="at">plot =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="final_paper_files/figure-html/Check%20Assumptions%20-%20Aggregated%20Percent%20Cover%20Model-28.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Object of Class DHARMa with simulated residuals based on 250 simulations with refit = FALSE . See ?DHARMa::simulateResiduals for help. 
 
Scaled residual values: 0.828 0.672 0.496 0.76 0.868 0.676 0.636 0.44 0.548 0.648 0.36 0.168 0.172 0.136 0.03316039 0.168 0.1199968 0.0639891 0.456 0.244 ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">testOutliers</span>(eelgrass_pc_glmm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="final_paper_files/figure-html/Check%20Assumptions%20-%20Aggregated%20Percent%20Cover%20Model-29.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    DHARMa outlier test based on exact binomial test with approximate
    expectations

data:  eelgrass_pc_glmm
outliers at both margin(s) = 0, observations = 109, p-value = 1
alternative hypothesis: true probability of success is not equal to 0.007968127
95 percent confidence interval:
 0.00000000 0.03327666
sample estimates:
frequency of outliers (expected: 0.00796812749003984 ) 
                                                     0 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="fu">testOutliers</span>(eelgrass_pc_glmm_3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="final_paper_files/figure-html/Check%20Assumptions%20-%20Aggregated%20Percent%20Cover%20Model-30.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    DHARMa outlier test based on exact binomial test with approximate
    expectations

data:  eelgrass_pc_glmm_3
outliers at both margin(s) = 2, observations = 109, p-value = 0.2158
alternative hypothesis: true probability of success is not equal to 0.007968127
95 percent confidence interval:
 0.002229879 0.064711856
sample estimates:
frequency of outliers (expected: 0.00796812749003984 ) 
                                            0.01834862 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="co"># no clear outliers</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="statistical-analysis-presence-absence-model" class="level4">
<h4 class="anchored" data-anchor-id="statistical-analysis-presence-absence-model">Statistical Analysis: Presence Absence Model</h4>
<p>The impact of PS-SSTA was next examined using binary presence or absence of eelgrass cover at the quadrat level. Again, a GLMM was fit with PS-SSTA and AMS-SST as the predictors, this time with a binomial error distribution and logit link to account for success-failure structured data. Random intercepts again included year and site, but in this case a random intercept of quadrat nested within site was also include to account for variability between quadrats. A random slope was again included for site.</p>
<pre><code>eelgrass_pa_glmm &lt;- glmmTMB(
  presence ~ PS_SSTA + AMS_SST + (1 + PS_SSTA | site) + (1 | site:site_quadrat) + (1 | year),
  family = binomial(link = "logit"),
  data = eelgrass_data)</code></pre>
<p>All of the same model checks were run for the presence-absence model, and again many of the assumptions passed but homoscedasticity failed as shown both by the DHARMa residuals vs.&nbsp;model predictions, as well as by the binned residuals falling significantly beyond the error bounds. This was likely driven once again by failures of the linearity and independence of errors assumptions. I applied the same method of including natural spline transformations for PS-SSTA with degrees of freedom 2 through 5, however in this instance none of the additional models fit the data significantly better according to an AIC analysis, and all continued to fail the homoscedasticity assumption. In addition to non-linearity, a possible explanation for this is a significant failure of the independence of errors assumptions, since there would be significant spatial autocorrelation between quadrats within the same transect, as well as temporal autocorrelation between measurements taken in successive years.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Build Model to predict presence absence at quadrat level:</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a><span class="co"># - Outcome is presence or absence (1 or 0)</span></span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a><span class="co"># - Predictors are:</span></span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a><span class="co">#   - Centered mean summer sst from the previous year (anomaly)</span></span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a><span class="co">#   - Site level mean summer SST for the study period</span></span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a><span class="co"># - Binomial error distribution because outcome is 1 or 0 (presence absence)</span></span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a><span class="co"># - Logit link because working with percentages bounded between 0 &amp; 1 (probability of presence)</span></span>
<span id="cb79-8"><a href="#cb79-8" aria-hidden="true" tabindex="-1"></a><span class="co"># - Random effects:</span></span>
<span id="cb79-9"><a href="#cb79-9" aria-hidden="true" tabindex="-1"></a><span class="co">#   - Site - random intercept and slope, as SST anomaly relationship may differ by site</span></span>
<span id="cb79-10"><a href="#cb79-10" aria-hidden="true" tabindex="-1"></a><span class="co">#   - Quadrat (nested within site) - random intercept</span></span>
<span id="cb79-11"><a href="#cb79-11" aria-hidden="true" tabindex="-1"></a><span class="co">#   - Year - random intercept, as certain years (e.g. those with major weather events) may</span></span>
<span id="cb79-12"><a href="#cb79-12" aria-hidden="true" tabindex="-1"></a><span class="co">#     have different intercept</span></span>
<span id="cb79-13"><a href="#cb79-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-14"><a href="#cb79-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-15"><a href="#cb79-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Mundlak Regression Approach</span></span>
<span id="cb79-16"><a href="#cb79-16" aria-hidden="true" tabindex="-1"></a>eelgrass_pa_glmm <span class="ot">&lt;-</span> <span class="fu">glmmTMB</span>(</span>
<span id="cb79-17"><a href="#cb79-17" aria-hidden="true" tabindex="-1"></a>  presence <span class="sc">~</span> sst_centered_prev <span class="sc">+</span> average_mean_sst <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> sst_centered_prev <span class="sc">|</span> site) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> site<span class="sc">:</span>site_quadrat) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> year),</span>
<span id="cb79-18"><a href="#cb79-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>),</span>
<span id="cb79-19"><a href="#cb79-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> eelgrass_data)</span>
<span id="cb79-20"><a href="#cb79-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-21"><a href="#cb79-21" aria-hidden="true" tabindex="-1"></a><span class="co"># DHARMa residuals test</span></span>
<span id="cb79-22"><a href="#cb79-22" aria-hidden="true" tabindex="-1"></a><span class="fu">simulateResiduals</span>(eelgrass_pa_glmm, <span class="at">plot =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="final_paper_files/figure-html/Quadrat%20Presence%20Absence%20Model-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Object of Class DHARMa with simulated residuals based on 250 simulations with refit = FALSE . See ?DHARMa::simulateResiduals for help. 
 
Scaled residual values: 0.7794219 0.3069562 0.2949095 0.1704718 0.9266316 0.1883908 0.0835219 0.689183 0.4331577 0.3350277 0.8270128 0.260343 0.3266501 0.8391447 0.6066419 0.1975209 0.7928631 0.8134602 0.5088314 0.1384656 ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Model fails linearity, based on DHARMa residuals</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Attempt to add splines with varying dfs to find best fitting non-linear model at lowest cost</span></span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>eelgrass_pa_glmm_2 <span class="ot">&lt;-</span> <span class="fu">glmmTMB</span>(</span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>  presence <span class="sc">~</span> splines<span class="sc">::</span><span class="fu">ns</span>(sst_centered_prev, <span class="at">df =</span> <span class="dv">2</span>) <span class="sc">+</span> average_mean_sst <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> sst_centered_prev <span class="sc">|</span> site) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> site<span class="sc">:</span>site_quadrat) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> year),</span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>),</span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> eelgrass_data)</span>
<span id="cb81-7"><a href="#cb81-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-8"><a href="#cb81-8" aria-hidden="true" tabindex="-1"></a>eelgrass_pa_glmm_3 <span class="ot">&lt;-</span> <span class="fu">glmmTMB</span>(</span>
<span id="cb81-9"><a href="#cb81-9" aria-hidden="true" tabindex="-1"></a>  presence <span class="sc">~</span> splines<span class="sc">::</span><span class="fu">ns</span>(sst_centered_prev, <span class="at">df =</span> <span class="dv">3</span>) <span class="sc">+</span> average_mean_sst <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> sst_centered_prev <span class="sc">|</span> site) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> site<span class="sc">:</span>site_quadrat) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> year),</span>
<span id="cb81-10"><a href="#cb81-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>),</span>
<span id="cb81-11"><a href="#cb81-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> eelgrass_data)</span>
<span id="cb81-12"><a href="#cb81-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-13"><a href="#cb81-13" aria-hidden="true" tabindex="-1"></a>eelgrass_pa_glmm_4 <span class="ot">&lt;-</span> <span class="fu">glmmTMB</span>(</span>
<span id="cb81-14"><a href="#cb81-14" aria-hidden="true" tabindex="-1"></a>  presence <span class="sc">~</span> splines<span class="sc">::</span><span class="fu">ns</span>(sst_centered_prev, <span class="at">df =</span> <span class="dv">4</span>) <span class="sc">+</span> average_mean_sst <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> sst_centered_prev <span class="sc">|</span> site) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> site<span class="sc">:</span>site_quadrat) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> year),</span>
<span id="cb81-15"><a href="#cb81-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>),</span>
<span id="cb81-16"><a href="#cb81-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> eelgrass_data)</span>
<span id="cb81-17"><a href="#cb81-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-18"><a href="#cb81-18" aria-hidden="true" tabindex="-1"></a>eelgrass_pa_glmm_5 <span class="ot">&lt;-</span> <span class="fu">glmmTMB</span>(</span>
<span id="cb81-19"><a href="#cb81-19" aria-hidden="true" tabindex="-1"></a>  presence <span class="sc">~</span> splines<span class="sc">::</span><span class="fu">ns</span>(sst_centered_prev, <span class="at">df =</span> <span class="dv">5</span>) <span class="sc">+</span> average_mean_sst <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> sst_centered_prev <span class="sc">|</span> site) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> site<span class="sc">:</span>site_quadrat) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> year),</span>
<span id="cb81-20"><a href="#cb81-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>),</span>
<span id="cb81-21"><a href="#cb81-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> eelgrass_data)</span>
<span id="cb81-22"><a href="#cb81-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-23"><a href="#cb81-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Check AICs</span></span>
<span id="cb81-24"><a href="#cb81-24" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(eelgrass_pa_glmm,</span>
<span id="cb81-25"><a href="#cb81-25" aria-hidden="true" tabindex="-1"></a>    eelgrass_pa_glmm_2,</span>
<span id="cb81-26"><a href="#cb81-26" aria-hidden="true" tabindex="-1"></a>    eelgrass_pa_glmm_3,</span>
<span id="cb81-27"><a href="#cb81-27" aria-hidden="true" tabindex="-1"></a>    eelgrass_pa_glmm_4,</span>
<span id="cb81-28"><a href="#cb81-28" aria-hidden="true" tabindex="-1"></a>    eelgrass_pa_glmm_5)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                   df      AIC
eelgrass_pa_glmm    8 927.7574
eelgrass_pa_glmm_2  9 929.2227
eelgrass_pa_glmm_3 10 931.0507
eelgrass_pa_glmm_4 11 932.8664
eelgrass_pa_glmm_5 12 932.6309</code></pre>
</div>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="co"># None of the attempted spline models have lower AICs</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Examine if any of the spline models pass DHARMa residuals</span></span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a><span class="fu">simulateResiduals</span>(eelgrass_pa_glmm_2, <span class="at">plot =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="final_paper_files/figure-html/Quadrat%20Presence%20Absence%20Model-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Object of Class DHARMa with simulated residuals based on 250 simulations with refit = FALSE . See ?DHARMa::simulateResiduals for help. 
 
Scaled residual values: 0.7724979 0.2906108 0.2949095 0.147214 0.9256446 0.1620886 0.07733509 0.6862782 0.4253928 0.3198457 0.8254473 0.2503476 0.3295905 0.8354039 0.5872386 0.1835038 0.786212 0.8091818 0.5022825 0.1152853 ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="fu">simulateResiduals</span>(eelgrass_pa_glmm_3, <span class="at">plot =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="final_paper_files/figure-html/Quadrat%20Presence%20Absence%20Model-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Object of Class DHARMa with simulated residuals based on 250 simulations with refit = FALSE . See ?DHARMa::simulateResiduals for help. 
 
Scaled residual values: 0.7724979 0.2938799 0.2851617 0.147214 0.9253156 0.1583311 0.07114828 0.6848258 0.4176278 0.3137729 0.8254473 0.243684 0.3295905 0.8331594 0.5801829 0.1799996 0.7824113 0.8074704 0.4979166 0.09596839 ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="fu">simulateResiduals</span>(eelgrass_pa_glmm_4, <span class="at">plot =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="final_paper_files/figure-html/Quadrat%20Presence%20Absence%20Model-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Object of Class DHARMa with simulated residuals based on 250 simulations with refit = FALSE . See ?DHARMa::simulateResiduals for help. 
 
Scaled residual values: 0.7724979 0.2938799 0.2851617 0.147214 0.9249866 0.1545737 0.06496147 0.6848258 0.4176278 0.3107365 0.8254473 0.2470158 0.3237097 0.8301667 0.5837108 0.172991 0.7786106 0.805759 0.4957336 0.09210501 ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="fu">simulateResiduals</span>(eelgrass_pa_glmm_5, <span class="at">plot =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="final_paper_files/figure-html/Quadrat%20Presence%20Absence%20Model-5.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Object of Class DHARMa with simulated residuals based on 250 simulations with refit = FALSE . See ?DHARMa::simulateResiduals for help. 
 
Scaled residual values: 0.7754654 0.2873418 0.2851617 0.1510903 0.9266316 0.1545737 0.06805488 0.6862782 0.4305694 0.3198457 0.8262301 0.243684 0.3119482 0.8264259 0.5801829 0.1694867 0.7776604 0.8023363 0.4870017 0.09596839 ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="co"># or if binned residuals look good</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a><span class="fu">check_model</span>(eelgrass_pa_glmm_2, <span class="at">check =</span> <span class="fu">c</span>(<span class="st">"binned_residuals"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="final_paper_files/figure-html/Quadrat%20Presence%20Absence%20Model-6.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="fu">check_model</span>(eelgrass_pa_glmm_3, <span class="at">check =</span> <span class="fu">c</span>(<span class="st">"binned_residuals"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="final_paper_files/figure-html/Quadrat%20Presence%20Absence%20Model-7.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="fu">check_model</span>(eelgrass_pa_glmm_4, <span class="at">check =</span> <span class="fu">c</span>(<span class="st">"binned_residuals"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="final_paper_files/figure-html/Quadrat%20Presence%20Absence%20Model-8.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="fu">check_model</span>(eelgrass_pa_glmm_5, <span class="at">check =</span> <span class="fu">c</span>(<span class="st">"binned_residuals"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="final_paper_files/figure-html/Quadrat%20Presence%20Absence%20Model-9.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="co"># None of the attempted spline models appear to be better than the linear model</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Sticking with only linear model, understanding that the relationship is likely not linear</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="fu">check_model</span>(eelgrass_pa_glmm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="final_paper_files/figure-html/Check%20Assumptions%20-%20Presence%20Absence%20Model-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Validity - Do X and Y Reflect Concepts I'm interested In</span></span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a><span class="co"># - Conceptual check</span></span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a><span class="co">#   - Yes, we are interested in water temperature, and sst anomalies can serve as a proxy for</span></span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a><span class="co">#     bottom water anomalies in shallow areas where eelgrass grows.</span></span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-6"><a href="#cb97-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Representativeness: Does Your Data Represent the Population?</span></span>
<span id="cb97-7"><a href="#cb97-7" aria-hidden="true" tabindex="-1"></a><span class="co"># - Conceptual check </span></span>
<span id="cb97-8"><a href="#cb97-8" aria-hidden="true" tabindex="-1"></a><span class="co">#   - Our sample we are working with only represents the population of the most shallow growing </span></span>
<span id="cb97-9"><a href="#cb97-9" aria-hidden="true" tabindex="-1"></a><span class="co">#     eelgrass on the Eastern US. Variety of different mean temps.</span></span>
<span id="cb97-10"><a href="#cb97-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-11"><a href="#cb97-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Model captures features in the data</span></span>
<span id="cb97-12"><a href="#cb97-12" aria-hidden="true" tabindex="-1"></a><span class="co"># - Posterior predictive check</span></span>
<span id="cb97-13"><a href="#cb97-13" aria-hidden="true" tabindex="-1"></a><span class="fu">check_predictions</span>(eelgrass_pa_glmm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="final_paper_files/figure-html/Check%20Assumptions%20-%20Presence%20Absence%20Model-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="co"># - Looks good!</span></span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Linearity</span></span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a><span class="co"># - Assuming linearity between the predictor and the log-odds (for binomial) </span></span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a><span class="co">#   or logit-transformed mean (for beta regression)</span></span>
<span id="cb98-6"><a href="#cb98-6" aria-hidden="true" tabindex="-1"></a><span class="co"># - Simulate residuals</span></span>
<span id="cb98-7"><a href="#cb98-7" aria-hidden="true" tabindex="-1"></a><span class="fu">simulateResiduals</span>(eelgrass_pa_glmm, <span class="at">plot =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="final_paper_files/figure-html/Check%20Assumptions%20-%20Presence%20Absence%20Model-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Object of Class DHARMa with simulated residuals based on 250 simulations with refit = FALSE . See ?DHARMa::simulateResiduals for help. 
 
Scaled residual values: 0.7794219 0.3069562 0.2949095 0.1704718 0.9266316 0.1883908 0.0835219 0.689183 0.4331577 0.3350277 0.8270128 0.260343 0.3266501 0.8391447 0.6066419 0.1975209 0.7928631 0.8134602 0.5088314 0.1384656 ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="fu">check_model</span>(eelgrass_pa_glmm, <span class="at">check =</span> <span class="fu">c</span>(<span class="st">"binned_residuals"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="final_paper_files/figure-html/Check%20Assumptions%20-%20Presence%20Absence%20Model-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="co"># - Residuals are inconsistent, so linearity likely fails.</span></span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a><span class="co"># - I tried adding splines. Spline with df = 2 seems better, but any higher df was bad</span></span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a><span class="co">#   and AIC was worse, so continuing with linear model despite failing assumption</span></span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a><span class="co"># - Relationship is likely NON linear</span></span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-6"><a href="#cb101-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Additivity</span></span>
<span id="cb101-7"><a href="#cb101-7" aria-hidden="true" tabindex="-1"></a><span class="co"># - Assumption that fixed effects impact is additive - they don't affect each other</span></span>
<span id="cb101-8"><a href="#cb101-8" aria-hidden="true" tabindex="-1"></a><span class="co">#   - Include interaction in the model, and see if it improves anything</span></span>
<span id="cb101-9"><a href="#cb101-9" aria-hidden="true" tabindex="-1"></a>eelgrass_pa_glmm_int <span class="ot">&lt;-</span> <span class="fu">glmmTMB</span>(</span>
<span id="cb101-10"><a href="#cb101-10" aria-hidden="true" tabindex="-1"></a>  presence <span class="sc">~</span> sst_centered_prev <span class="sc">*</span> average_mean_sst <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> sst_centered_prev <span class="sc">|</span> site) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> site<span class="sc">:</span>site_quadrat) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> year),</span>
<span id="cb101-11"><a href="#cb101-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>),</span>
<span id="cb101-12"><a href="#cb101-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> eelgrass_data)</span>
<span id="cb101-13"><a href="#cb101-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-14"><a href="#cb101-14" aria-hidden="true" tabindex="-1"></a><span class="fu">check_model</span>(eelgrass_pa_glmm_int)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="final_paper_files/figure-html/Check%20Assumptions%20-%20Presence%20Absence%20Model-5.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="fu">simulateResiduals</span>(eelgrass_pa_glmm_int, <span class="at">plot =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="final_paper_files/figure-html/Check%20Assumptions%20-%20Presence%20Absence%20Model-6.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Object of Class DHARMa with simulated residuals based on 250 simulations with refit = FALSE . See ?DHARMa::simulateResiduals for help. 
 
Scaled residual values: 0.7814002 0.3036871 0.2981587 0.1704718 0.9272896 0.1959057 0.0835219 0.6877306 0.4305694 0.3319913 0.8270128 0.2636747 0.3295905 0.8413892 0.6066419 0.2045295 0.7947635 0.8117489 0.5153803 0.1384656 ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Also can compare models directly</span></span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(eelgrass_pa_glmm, eelgrass_pa_glmm_int, <span class="at">test =</span> <span class="st">"Chisq"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Data: eelgrass_data
Models:
eelgrass_pa_glmm: presence ~ sst_centered_prev + average_mean_sst + (1 + sst_centered_prev | , zi=~0, disp=~1
eelgrass_pa_glmm:     site) + (1 | site:site_quadrat) + (1 | year), zi=~0, disp=~1
eelgrass_pa_glmm_int: presence ~ sst_centered_prev * average_mean_sst + (1 + sst_centered_prev | , zi=~0, disp=~1
eelgrass_pa_glmm_int:     site) + (1 | site:site_quadrat) + (1 | year), zi=~0, disp=~1
                     Df    AIC    BIC  logLik deviance  Chisq Chi Df Pr(&gt;Chisq)
eelgrass_pa_glmm      8 927.76 969.17 -455.88   911.76                         
eelgrass_pa_glmm_int  9 928.93 975.51 -455.46   910.93 0.8298      1     0.3623</code></pre>
</div>
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check AICs to see if including interaction fits data better</span></span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(eelgrass_pa_glmm, eelgrass_pa_glmm_int)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                     df      AIC
eelgrass_pa_glmm      8 927.7574
eelgrass_pa_glmm_int  9 928.9276</code></pre>
</div>
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Additivity assumption seems okay - including interaction does not improve model</span></span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Independence of errors</span></span>
<span id="cb108-5"><a href="#cb108-5" aria-hidden="true" tabindex="-1"></a><span class="co"># - Are all replicates truly independent?</span></span>
<span id="cb108-6"><a href="#cb108-6" aria-hidden="true" tabindex="-1"></a><span class="co">#   - Look at fitted values vs residuals</span></span>
<span id="cb108-7"><a href="#cb108-7" aria-hidden="true" tabindex="-1"></a><span class="fu">simulateResiduals</span>(eelgrass_pa_glmm, <span class="at">plot =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="final_paper_files/figure-html/Check%20Assumptions%20-%20Presence%20Absence%20Model-7.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Object of Class DHARMa with simulated residuals based on 250 simulations with refit = FALSE . See ?DHARMa::simulateResiduals for help. 
 
Scaled residual values: 0.7794219 0.3069562 0.2949095 0.1704718 0.9266316 0.1883908 0.0835219 0.689183 0.4331577 0.3350277 0.8270128 0.260343 0.3266501 0.8391447 0.6066419 0.1975209 0.7928631 0.8134602 0.5088314 0.1384656 ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="fu">testResiduals</span>(eelgrass_pa_glmm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="final_paper_files/figure-html/Check%20Assumptions%20-%20Presence%20Absence%20Model-8.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>$uniformity

    Asymptotic one-sample Kolmogorov-Smirnov test

data:  simulationOutput$scaledResiduals
D = 0.033291, p-value = 0.1101
alternative hypothesis: two-sided


$dispersion

    DHARMa nonparametric dispersion test via sd of residuals fitted vs.
    simulated

data:  simulationOutput
dispersion = 1.0403, p-value = 0.968
alternative hypothesis: two.sided


$outliers

    DHARMa outlier test based on exact binomial test with approximate
    expectations

data:  simulationOutput
outliers at both margin(s) = 9, observations = 1308, p-value = 0.8755
alternative hypothesis: true probability of success is not equal to 0.007968127
95 percent confidence interval:
 0.003150995 0.013021428
sample estimates:
frequency of outliers (expected: 0.00796812749003984 ) 
                                           0.006880734 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="co">#   - DHARMa Residuals vs fitted values (model predictions) fail. This could be due to non-linearity,</span></span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a><span class="co">#     but also error terms may not be independent</span></span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a><span class="co">#   - Logically samples will be correlated year to year, within site, </span></span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a><span class="co">#     and between neighboring quadrats.</span></span>
<span id="cb112-5"><a href="#cb112-5" aria-hidden="true" tabindex="-1"></a><span class="co">#   - Inclusion of random effects for year, site, and site_quadrat attempts to handle how</span></span>
<span id="cb112-6"><a href="#cb112-6" aria-hidden="true" tabindex="-1"></a><span class="co">#     different years, sites, and quadrats behave, but I suspect temporal and within-site </span></span>
<span id="cb112-7"><a href="#cb112-7" aria-hidden="true" tabindex="-1"></a><span class="co">#     autocorrelation is still an issue.</span></span>
<span id="cb112-8"><a href="#cb112-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-9"><a href="#cb112-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Homoscedasticity of the errors (constant variance AKA homogeneity of variance)</span></span>
<span id="cb112-10"><a href="#cb112-10" aria-hidden="true" tabindex="-1"></a><span class="co"># - Plot fitted values vs sqrt of sd of residuals</span></span>
<span id="cb112-11"><a href="#cb112-11" aria-hidden="true" tabindex="-1"></a><span class="co"># check_model(eelgrass_pa_glmm, check = c("homogeneity"))</span></span>
<span id="cb112-12"><a href="#cb112-12" aria-hidden="true" tabindex="-1"></a><span class="co"># - This is the least "flat and horizontal" line ever. But for non-gaussian this is</span></span>
<span id="cb112-13"><a href="#cb112-13" aria-hidden="true" tabindex="-1"></a><span class="co">#   relaxed. </span></span>
<span id="cb112-14"><a href="#cb112-14" aria-hidden="true" tabindex="-1"></a><span class="co"># - We should actually check residuals QQ plot</span></span>
<span id="cb112-15"><a href="#cb112-15" aria-hidden="true" tabindex="-1"></a><span class="co"># - Look at quantile residuals</span></span>
<span id="cb112-16"><a href="#cb112-16" aria-hidden="true" tabindex="-1"></a><span class="fu">simulateResiduals</span>(eelgrass_pa_glmm, <span class="at">plot =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="final_paper_files/figure-html/Check%20Assumptions%20-%20Presence%20Absence%20Model-9.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Object of Class DHARMa with simulated residuals based on 250 simulations with refit = FALSE . See ?DHARMa::simulateResiduals for help. 
 
Scaled residual values: 0.7794219 0.3069562 0.2949095 0.1704718 0.9266316 0.1883908 0.0835219 0.689183 0.4331577 0.3350277 0.8270128 0.260343 0.3266501 0.8391447 0.6066419 0.1975209 0.7928631 0.8134602 0.5088314 0.1384656 ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="fu">check_model</span>(eelgrass_pa_glmm, <span class="at">check =</span> <span class="fu">c</span>(<span class="st">"qq"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="final_paper_files/figure-html/Check%20Assumptions%20-%20Presence%20Absence%20Model-10.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Looks good</span></span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Overdispersion</span></span>
<span id="cb115-4"><a href="#cb115-4" aria-hidden="true" tabindex="-1"></a><span class="co"># - Is observed variance higher than the variance of the theoretical model?</span></span>
<span id="cb115-5"><a href="#cb115-5" aria-hidden="true" tabindex="-1"></a><span class="fu">simulateResiduals</span>(eelgrass_pa_glmm, <span class="at">plot =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="final_paper_files/figure-html/Check%20Assumptions%20-%20Presence%20Absence%20Model-11.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Object of Class DHARMa with simulated residuals based on 250 simulations with refit = FALSE . See ?DHARMa::simulateResiduals for help. 
 
Scaled residual values: 0.7794219 0.3069562 0.2949095 0.1704718 0.9266316 0.1883908 0.0835219 0.689183 0.4331577 0.3350277 0.8270128 0.260343 0.3266501 0.8391447 0.6066419 0.1975209 0.7928631 0.8134602 0.5088314 0.1384656 ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="fu">testDispersion</span>(eelgrass_pa_glmm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="final_paper_files/figure-html/Check%20Assumptions%20-%20Presence%20Absence%20Model-12.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    DHARMa nonparametric dispersion test via sd of residuals fitted vs.
    simulated

data:  simulationOutput
dispersion = 1.0403, p-value = 0.968
alternative hypothesis: two.sided</code></pre>
</div>
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Looks good</span></span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Endogeneity - Predictor is not correlated with the error term</span></span>
<span id="cb119-4"><a href="#cb119-4" aria-hidden="true" tabindex="-1"></a><span class="co"># - For glmm, this is predominantly argued logically, based on theory/DAG</span></span>
<span id="cb119-5"><a href="#cb119-5" aria-hidden="true" tabindex="-1"></a><span class="co">#   - This may not pass, because SST anomaly could be correlated with storm events </span></span>
<span id="cb119-6"><a href="#cb119-6" aria-hidden="true" tabindex="-1"></a><span class="co">#     (e.g. mixing impacting SST and eelgrass), turbidity from chlorophyll, and other error. </span></span>
<span id="cb119-7"><a href="#cb119-7" aria-hidden="true" tabindex="-1"></a><span class="co">#     But generally, we assume the majority of factors influencing eelgrass cover would not</span></span>
<span id="cb119-8"><a href="#cb119-8" aria-hidden="true" tabindex="-1"></a><span class="co">#     be correlated with SST anomaly, such as boating/fishing activity...? Including year as </span></span>
<span id="cb119-9"><a href="#cb119-9" aria-hidden="true" tabindex="-1"></a><span class="co">#     random effect also helps account for storm events. </span></span>
<span id="cb119-10"><a href="#cb119-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-11"><a href="#cb119-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Check error distribution</span></span>
<span id="cb119-12"><a href="#cb119-12" aria-hidden="true" tabindex="-1"></a><span class="co"># - Don't assume normality of error distribution for GLMMs</span></span>
<span id="cb119-13"><a href="#cb119-13" aria-hidden="true" tabindex="-1"></a><span class="co"># - Instead, assume uniformity of scaled residuals - See DHARMa KS test </span></span>
<span id="cb119-14"><a href="#cb119-14" aria-hidden="true" tabindex="-1"></a><span class="fu">simulateResiduals</span>(eelgrass_pa_glmm, <span class="at">plot =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="final_paper_files/figure-html/Check%20Assumptions%20-%20Presence%20Absence%20Model-13.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Object of Class DHARMa with simulated residuals based on 250 simulations with refit = FALSE . See ?DHARMa::simulateResiduals for help. 
 
Scaled residual values: 0.7794219 0.3069562 0.2949095 0.1704718 0.9266316 0.1883908 0.0835219 0.689183 0.4331577 0.3350277 0.8270128 0.260343 0.3266501 0.8391447 0.6066419 0.1975209 0.7928631 0.8134602 0.5088314 0.1384656 ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Looks good</span></span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-3"><a href="#cb121-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Normality of random effects</span></span>
<span id="cb121-4"><a href="#cb121-4" aria-hidden="true" tabindex="-1"></a><span class="fu">check_model</span>(eelgrass_pa_glmm, <span class="at">check =</span> <span class="fu">c</span>(<span class="st">"reqq"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="final_paper_files/figure-html/Check%20Assumptions%20-%20Presence%20Absence%20Model-14.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="co"># There are slight tails for quadrat, and slight patter for year, but overall looks good</span></span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Minimal outlier influence</span></span>
<span id="cb122-4"><a href="#cb122-4" aria-hidden="true" tabindex="-1"></a><span class="fu">simulateResiduals</span>(eelgrass_pa_glmm, <span class="at">plot =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="final_paper_files/figure-html/Check%20Assumptions%20-%20Presence%20Absence%20Model-15.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Object of Class DHARMa with simulated residuals based on 250 simulations with refit = FALSE . See ?DHARMa::simulateResiduals for help. 
 
Scaled residual values: 0.7794219 0.3069562 0.2949095 0.1704718 0.9266316 0.1883908 0.0835219 0.689183 0.4331577 0.3350277 0.8270128 0.260343 0.3266501 0.8391447 0.6066419 0.1975209 0.7928631 0.8134602 0.5088314 0.1384656 ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="fu">testOutliers</span>(eelgrass_pa_glmm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="final_paper_files/figure-html/Check%20Assumptions%20-%20Presence%20Absence%20Model-16.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    DHARMa outlier test based on exact binomial test with approximate
    expectations

data:  eelgrass_pa_glmm
outliers at both margin(s) = 9, observations = 1308, p-value = 0.8755
alternative hypothesis: true probability of success is not equal to 0.007968127
95 percent confidence interval:
 0.003150995 0.013021428
sample estimates:
frequency of outliers (expected: 0.00796812749003984 ) 
                                           0.006880734 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="co"># No clear outliers</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="results-aggregated-percent-cover-model" class="level3">
<h3 class="anchored" data-anchor-id="results-aggregated-percent-cover-model">Results: Aggregated Percent Cover Model</h3>
<p>Overall the linear aggregated percent cover model estimates that eelgrass percent cover declines with increases in both PS-SSTA and AMS-SST, however slope standard error and the corresponding 95% confidence interval are quite large, especially for PS-SSTA. This relationship between PS-SSTA and percent cover is not consistent at each site, with the Fort Getty site displaying an opposing trend of increased percent cover at higher SST anomalies, despite the nearby T-Dock site also located in Narragansett Bay staying in line with the overall negative trend. Duck Harbor and Pleasant Bay, both located on Cape Cod, MA are the only two sites with multiple SST anomalies below a -1°C, with 4 at each out of 109 total measurements. As a result, confidence intervals are very wide for all other sites in this lower anomaly range.</p>
<div class="columns center">
<div class="column" style="border-right: 1px solid #ccc; padding-right: 1em;">
<ol type="a">
<li></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot linear model across all data, not separating by site</span></span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(eelgrass_data_aggregated, <span class="fu">aes</span>(<span class="at">x =</span> sst_centered_prev, <span class="at">y =</span> percent_cover)) <span class="sc">+</span></span>
<span id="cb127-3"><a href="#cb127-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb127-4"><a href="#cb127-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(</span>
<span id="cb127-5"><a href="#cb127-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> pred_grid_ag_lin,</span>
<span id="cb127-6"><a href="#cb127-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">y =</span> predicted, <span class="at">color =</span> average_mean_sst, <span class="at">group =</span> average_mean_sst),</span>
<span id="cb127-7"><a href="#cb127-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb127-8"><a href="#cb127-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(</span>
<span id="cb127-9"><a href="#cb127-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> pred_grid_ag_lin,</span>
<span id="cb127-10"><a href="#cb127-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> sst_centered_prev, <span class="at">y =</span> predicted,</span>
<span id="cb127-11"><a href="#cb127-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">ymin =</span> lower, <span class="at">ymax =</span> upper, </span>
<span id="cb127-12"><a href="#cb127-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">group =</span> average_mean_sst),</span>
<span id="cb127-13"><a href="#cb127-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">linetype =</span> <span class="dv">0</span>, <span class="at">alpha =</span> <span class="fl">0.1</span>,</span>
<span id="cb127-14"><a href="#cb127-14" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb127-15"><a href="#cb127-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_gradient</span>(<span class="at">low =</span> <span class="st">"blue"</span>, <span class="at">high =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb127-16"><a href="#cb127-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb127-17"><a href="#cb127-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Eelgrass Percent Cover Predicted by SST Anomaly"</span>,</span>
<span id="cb127-18"><a href="#cb127-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"(Linear Model)"</span>,</span>
<span id="cb127-19"><a href="#cb127-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"SST Anomaly (°C)"</span>,</span>
<span id="cb127-20"><a href="#cb127-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Percent Cover"</span>,</span>
<span id="cb127-21"><a href="#cb127-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Average Mean </span></span>
<span id="cb127-22"><a href="#cb127-22" aria-hidden="true" tabindex="-1"></a><span class="st">Summer SST (°C)"</span>,</span>
<span id="cb127-23"><a href="#cb127-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> <span class="st">"Ribbon = 95% CI"</span></span>
<span id="cb127-24"><a href="#cb127-24" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb127-25"><a href="#cb127-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">label_percent</span>()) <span class="sc">+</span></span>
<span id="cb127-26"><a href="#cb127-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.caption.position =</span> <span class="st">"plot"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="final_paper_files/figure-html/Visualize%20Aggregated%20Percent%20Cover%20Model%20-%20Linear%201-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:50%;">
<ol start="2" type="a">
<li></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot linear model across all data, faceting by site</span></span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(eelgrass_data_aggregated, </span>
<span id="cb128-3"><a href="#cb128-3" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> sst_centered_prev, <span class="at">y =</span> percent_cover, <span class="at">color =</span> site)) <span class="sc">+</span></span>
<span id="cb128-4"><a href="#cb128-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb128-5"><a href="#cb128-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(</span>
<span id="cb128-6"><a href="#cb128-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> pred_grid_ag_site_lin, </span>
<span id="cb128-7"><a href="#cb128-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">y =</span> predicted, <span class="at">group =</span> site)) <span class="sc">+</span></span>
<span id="cb128-8"><a href="#cb128-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(</span>
<span id="cb128-9"><a href="#cb128-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> pred_grid_ag_site_lin,</span>
<span id="cb128-10"><a href="#cb128-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> sst_centered_prev, <span class="at">y =</span> predicted,</span>
<span id="cb128-11"><a href="#cb128-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">ymin =</span> lower, <span class="at">ymax =</span> upper, </span>
<span id="cb128-12"><a href="#cb128-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">fill =</span> site, <span class="at">group =</span> site),</span>
<span id="cb128-13"><a href="#cb128-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">linetype =</span> <span class="dv">0</span>, <span class="at">alpha =</span> <span class="fl">0.2</span>,</span>
<span id="cb128-14"><a href="#cb128-14" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb128-15"><a href="#cb128-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">palette =</span> <span class="st">"Dark2"</span>) <span class="sc">+</span></span>
<span id="cb128-16"><a href="#cb128-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Dark2"</span>) <span class="sc">+</span></span>
<span id="cb128-17"><a href="#cb128-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb128-18"><a href="#cb128-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Eelgrass Percent Cover Predicted by SST Anomaly"</span>,</span>
<span id="cb128-19"><a href="#cb128-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"(Linear Model)"</span>,</span>
<span id="cb128-20"><a href="#cb128-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"SST Anomaly (°C)"</span>,</span>
<span id="cb128-21"><a href="#cb128-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Percent Cover"</span>,</span>
<span id="cb128-22"><a href="#cb128-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Site"</span>,</span>
<span id="cb128-23"><a href="#cb128-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Site"</span>,</span>
<span id="cb128-24"><a href="#cb128-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> <span class="st">"Ribbon = 95% CI"</span></span>
<span id="cb128-25"><a href="#cb128-25" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb128-26"><a href="#cb128-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb128-27"><a href="#cb128-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.caption.position =</span> <span class="st">"plot"</span>, </span>
<span id="cb128-28"><a href="#cb128-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb128-29"><a href="#cb128-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">label_percent</span>()) <span class="sc">+</span></span>
<span id="cb128-30"><a href="#cb128-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>site)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="final_paper_files/figure-html/Visualize%20Aggregated%20Percent%20Cover%20Model%20-%20Linear%202-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
<p><em>Figure 4 - Results from the linear aggregated percent cover model. a) Eelgrass percent cover predicted by Previous Summer SST Anomaly (PS-SSTA). Individual curves depict model predictions at distinct Average Mean Summer SSTs (AMS-SST) corresponding to those of each study site. Ribbons depict 95% confidence intervals, and points represent individual transect-year observations. b) Eelgrass percent cover predicted by PS-SSTA for each study site, with 95% confidence intervals. Points represent individual transect-year observations.</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom.mixed)</span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb129-4"><a href="#cb129-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb129-5"><a href="#cb129-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-6"><a href="#cb129-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Output table of summary statistics</span></span>
<span id="cb129-7"><a href="#cb129-7" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(eelgrass_pc_glmm) <span class="sc">|&gt;</span> </span>
<span id="cb129-8"><a href="#cb129-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(estimate<span class="sc">:</span>p.value, <span class="sc">~</span><span class="fu">round</span>(., <span class="dv">3</span>))) <span class="sc">|&gt;</span></span>
<span id="cb129-9"><a href="#cb129-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>() <span class="sc">|&gt;</span> </span>
<span id="cb129-10"><a href="#cb129-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">font_size =</span> <span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table caption-top table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">effect</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">component</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">group</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">term</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">std.error</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">statistic</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">fixed</td>
<td style="text-align: left;">cond</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">3.994</td>
<td style="text-align: right;">2.703</td>
<td style="text-align: right;">1.478</td>
<td style="text-align: right;">0.139</td>
</tr>
<tr class="even">
<td style="text-align: left;">fixed</td>
<td style="text-align: left;">cond</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">sst_centered_prev</td>
<td style="text-align: right;">-0.313</td>
<td style="text-align: right;">0.292</td>
<td style="text-align: right;">-1.073</td>
<td style="text-align: right;">0.283</td>
</tr>
<tr class="odd">
<td style="text-align: left;">fixed</td>
<td style="text-align: left;">cond</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">average_mean_sst</td>
<td style="text-align: right;">-0.239</td>
<td style="text-align: right;">0.141</td>
<td style="text-align: right;">-1.701</td>
<td style="text-align: right;">0.089</td>
</tr>
<tr class="even">
<td style="text-align: left;">fixed</td>
<td style="text-align: left;">zi</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">-1.760</td>
<td style="text-align: right;">0.271</td>
<td style="text-align: right;">-6.503</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ran_pars</td>
<td style="text-align: left;">cond</td>
<td style="text-align: left;">site</td>
<td style="text-align: left;">sd__(Intercept)</td>
<td style="text-align: right;">0.674</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">ran_pars</td>
<td style="text-align: left;">cond</td>
<td style="text-align: left;">site</td>
<td style="text-align: left;">sd__sst_centered_prev</td>
<td style="text-align: right;">0.569</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ran_pars</td>
<td style="text-align: left;">cond</td>
<td style="text-align: left;">site</td>
<td style="text-align: left;">cor__(Intercept).sst_centered_prev</td>
<td style="text-align: right;">0.540</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">ran_pars</td>
<td style="text-align: left;">cond</td>
<td style="text-align: left;">year</td>
<td style="text-align: left;">sd__(Intercept)</td>
<td style="text-align: right;">0.320</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
</tbody>
</table>


</div>
</div>
<p><em>Table 1 - Summary statistics for the linear aggregated percent cover model.</em></p>
<p>The non-linear spline model shows eelgrass percent cover quickly dropping off from high values around -2°C PS-SSTA to much lower values around -0.5°C, and then largely leveling off. Notably, this same initial trend of decreasing percent cover with increasing PS-SSTA between -2°C and -0.5°C is shown at all sites, however the trend then flips at Fort Getty and Pleasant Bay with percent cover increasing as PS-SSTA increases. Meanwhile the negative trend continues at the T-Dock site, rather than leveling off as seen in the overall model and at the other 5 sites. The spline model appears to be even more heavily influenced by the high percent cover, low SST anomaly measurements at Duck Harbor and Pleasant Bay. Regarding average mean summer temperature, a trend of decreasing percent cover with increasing AMS-SST similar to that of the linear model is seen, which is logical as no spline transformation was applied to the AMS-SST.</p>
<div class="columns center">
<div class="column" style="border-right: 1px solid #ccc; padding-right: 1em;">
<ol type="a">
<li></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot spline model across all data, not separating by site</span></span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(eelgrass_data_aggregated, <span class="fu">aes</span>(<span class="at">x =</span> sst_centered_prev, <span class="at">y =</span> percent_cover)) <span class="sc">+</span></span>
<span id="cb130-3"><a href="#cb130-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb130-4"><a href="#cb130-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(</span>
<span id="cb130-5"><a href="#cb130-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> pred_grid_ag_spline,</span>
<span id="cb130-6"><a href="#cb130-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">y =</span> predicted, <span class="at">color =</span> average_mean_sst, <span class="at">group =</span> average_mean_sst),</span>
<span id="cb130-7"><a href="#cb130-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb130-8"><a href="#cb130-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(</span>
<span id="cb130-9"><a href="#cb130-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> pred_grid_ag_spline,</span>
<span id="cb130-10"><a href="#cb130-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> sst_centered_prev, <span class="at">y =</span> predicted,</span>
<span id="cb130-11"><a href="#cb130-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">ymin =</span> lower, <span class="at">ymax =</span> upper, </span>
<span id="cb130-12"><a href="#cb130-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">group =</span> average_mean_sst),</span>
<span id="cb130-13"><a href="#cb130-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">linetype =</span> <span class="dv">0</span>, <span class="at">alpha =</span> <span class="fl">0.1</span>,</span>
<span id="cb130-14"><a href="#cb130-14" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb130-15"><a href="#cb130-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_gradient</span>(<span class="at">low =</span> <span class="st">"blue"</span>, <span class="at">high =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb130-16"><a href="#cb130-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb130-17"><a href="#cb130-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Eelgrass Percent Cover Predicted by SST Anomaly"</span>,</span>
<span id="cb130-18"><a href="#cb130-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"(Spline Transformed SST Anomaly Model)"</span>,</span>
<span id="cb130-19"><a href="#cb130-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"SST Anomaly (°C)"</span>,</span>
<span id="cb130-20"><a href="#cb130-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Percent Cover"</span>,</span>
<span id="cb130-21"><a href="#cb130-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Average Mean</span></span>
<span id="cb130-22"><a href="#cb130-22" aria-hidden="true" tabindex="-1"></a><span class="st">Summer SST (°C)"</span>,</span>
<span id="cb130-23"><a href="#cb130-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> <span class="st">"Ribbon = 95% CI"</span></span>
<span id="cb130-24"><a href="#cb130-24" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb130-25"><a href="#cb130-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">label_percent</span>()) <span class="sc">+</span></span>
<span id="cb130-26"><a href="#cb130-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.caption.position =</span> <span class="st">"plot"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="final_paper_files/figure-html/Visualize%20Aggregated%20Percent%20Cover%20Model%20-%20Spline%201-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:50%;">
<ol start="2" type="a">
<li></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot spline model across all data, faceting by site</span></span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(eelgrass_data_aggregated, </span>
<span id="cb131-3"><a href="#cb131-3" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> sst_centered_prev, <span class="at">y =</span> percent_cover, <span class="at">color =</span> site)) <span class="sc">+</span></span>
<span id="cb131-4"><a href="#cb131-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb131-5"><a href="#cb131-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(</span>
<span id="cb131-6"><a href="#cb131-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> pred_grid_ag_site_spline, </span>
<span id="cb131-7"><a href="#cb131-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">y =</span> predicted, <span class="at">group =</span> site)) <span class="sc">+</span></span>
<span id="cb131-8"><a href="#cb131-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(</span>
<span id="cb131-9"><a href="#cb131-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> pred_grid_ag_site_spline,</span>
<span id="cb131-10"><a href="#cb131-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> sst_centered_prev, <span class="at">y =</span> predicted,</span>
<span id="cb131-11"><a href="#cb131-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">ymin =</span> lower, <span class="at">ymax =</span> upper, </span>
<span id="cb131-12"><a href="#cb131-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">fill =</span> site, <span class="at">group =</span> site),</span>
<span id="cb131-13"><a href="#cb131-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">linetype =</span> <span class="dv">0</span>, <span class="at">alpha =</span> <span class="fl">0.2</span>,</span>
<span id="cb131-14"><a href="#cb131-14" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb131-15"><a href="#cb131-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">palette =</span> <span class="st">"Dark2"</span>) <span class="sc">+</span></span>
<span id="cb131-16"><a href="#cb131-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Dark2"</span>) <span class="sc">+</span></span>
<span id="cb131-17"><a href="#cb131-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb131-18"><a href="#cb131-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Eelgrass Percent Cover Predicted by SST Anomaly"</span>,</span>
<span id="cb131-19"><a href="#cb131-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"(Spline Transformed SST Anomaly Model)"</span>,</span>
<span id="cb131-20"><a href="#cb131-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"SST Anomaly (°C)"</span>,</span>
<span id="cb131-21"><a href="#cb131-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Percent Cover"</span>,</span>
<span id="cb131-22"><a href="#cb131-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Site"</span>,</span>
<span id="cb131-23"><a href="#cb131-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Site"</span>,</span>
<span id="cb131-24"><a href="#cb131-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> <span class="st">"Ribbon = 95% CI"</span></span>
<span id="cb131-25"><a href="#cb131-25" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb131-26"><a href="#cb131-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb131-27"><a href="#cb131-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.caption.position =</span> <span class="st">"plot"</span>, </span>
<span id="cb131-28"><a href="#cb131-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb131-29"><a href="#cb131-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">label_percent</span>()) <span class="sc">+</span></span>
<span id="cb131-30"><a href="#cb131-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>site)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="final_paper_files/figure-html/Visualize%20Aggregated%20Percent%20Cover%20Model%20-%20Spline%202-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
<p><em>Figure 5 - Results from the non-linear aggregated percent cover spline model. a) Eelgrass percent cover predicted by Previous Summer SST Anomaly (PS-SSTA). Individual curves depict model predictions at distinct Average Mean Summer SSTs (AMS-SST) corresponding to those of each study site. Ribbons depict 95% confidence intervals, and points represent individual transect-year observations. b) Eelgrass percent cover predicted by PS-SSTA for each study site, with 95% confidence intervals. Points represent individual transect-year observations.</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom.mixed)</span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb132-3"><a href="#cb132-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb132-4"><a href="#cb132-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb132-5"><a href="#cb132-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-6"><a href="#cb132-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Output table of summary statistics</span></span>
<span id="cb132-7"><a href="#cb132-7" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(eelgrass_pc_glmm_3) <span class="sc">|&gt;</span> </span>
<span id="cb132-8"><a href="#cb132-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(estimate<span class="sc">:</span>p.value, <span class="sc">~</span><span class="fu">round</span>(., <span class="dv">3</span>))) <span class="sc">|&gt;</span></span>
<span id="cb132-9"><a href="#cb132-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>() <span class="sc">|&gt;</span> </span>
<span id="cb132-10"><a href="#cb132-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">font_size =</span> <span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table caption-top table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">effect</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">component</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">group</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">term</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">std.error</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">statistic</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">fixed</td>
<td style="text-align: left;">cond</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">7.128</td>
<td style="text-align: right;">3.124</td>
<td style="text-align: right;">2.282</td>
<td style="text-align: right;">0.023</td>
</tr>
<tr class="even">
<td style="text-align: left;">fixed</td>
<td style="text-align: left;">cond</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">splines::ns(sst_centered_prev, df = 3)1</td>
<td style="text-align: right;">-1.634</td>
<td style="text-align: right;">0.724</td>
<td style="text-align: right;">-2.257</td>
<td style="text-align: right;">0.024</td>
</tr>
<tr class="odd">
<td style="text-align: left;">fixed</td>
<td style="text-align: left;">cond</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">splines::ns(sst_centered_prev, df = 3)2</td>
<td style="text-align: right;">-6.453</td>
<td style="text-align: right;">2.057</td>
<td style="text-align: right;">-3.138</td>
<td style="text-align: right;">0.002</td>
</tr>
<tr class="even">
<td style="text-align: left;">fixed</td>
<td style="text-align: left;">cond</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">splines::ns(sst_centered_prev, df = 3)3</td>
<td style="text-align: right;">-0.819</td>
<td style="text-align: right;">0.864</td>
<td style="text-align: right;">-0.948</td>
<td style="text-align: right;">0.343</td>
</tr>
<tr class="odd">
<td style="text-align: left;">fixed</td>
<td style="text-align: left;">cond</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">average_mean_sst</td>
<td style="text-align: right;">-0.244</td>
<td style="text-align: right;">0.155</td>
<td style="text-align: right;">-1.578</td>
<td style="text-align: right;">0.114</td>
</tr>
<tr class="even">
<td style="text-align: left;">fixed</td>
<td style="text-align: left;">zi</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">-1.760</td>
<td style="text-align: right;">0.271</td>
<td style="text-align: right;">-6.503</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ran_pars</td>
<td style="text-align: left;">cond</td>
<td style="text-align: left;">site</td>
<td style="text-align: left;">sd__(Intercept)</td>
<td style="text-align: right;">0.736</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">ran_pars</td>
<td style="text-align: left;">cond</td>
<td style="text-align: left;">site</td>
<td style="text-align: left;">sd__sst_centered_prev</td>
<td style="text-align: right;">0.610</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ran_pars</td>
<td style="text-align: left;">cond</td>
<td style="text-align: left;">site</td>
<td style="text-align: left;">cor__(Intercept).sst_centered_prev</td>
<td style="text-align: right;">0.260</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">ran_pars</td>
<td style="text-align: left;">cond</td>
<td style="text-align: left;">year</td>
<td style="text-align: left;">sd__(Intercept)</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
</tbody>
</table>


</div>
</div>
<p><em>Table 2 - Summary statistics for the non-linear aggregated percent cover spline model.</em></p>
</section>
<section id="results-presence-absence-model" class="level3">
<h3 class="anchored" data-anchor-id="results-presence-absence-model">Results: Presence Absence Model</h3>
<p>The presence-absence model shows a decreasing probability of eelgrass presence with both increasing PS-SSTA and increasing AMS-SST, in parallel with the linear percent cover. The predicted values appear to fall above (greater probability of presence) most of the observed data when data is binned into similar SST anomaly ranges, despite the posterior predictive check showing predicted values aligning with observed data. This may be explained by the Fort Getty and Salem Sound sites which exhibit presence at nearly 100% of quadrat observations, potentially leading the model to predict higher probabilities of presence despite lower proportions of presence at other sites. Conversely, presence at nearly 0% of Fire Island quadrat observations may bring down the binned proportions of presence.</p>
<p>Once again trends vary between sites, with site-level model predictions generally follow the trend of observed data at each site. A consequence of this is the model predicts essentially 100% probability of eelgrass presence at Fort Getty and Salem Sound with an extremely narrow confidence interval, because very few quadrats exhibited a total absence of cover throughout the monitoring period.</p>
<div class="columns center">
<div class="column" style="border-right: 1px solid #ccc; padding-right: 1em;">
<ol type="a">
<li></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot modeled probability of presence with proportion of presence binned by sst anomaly</span></span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(binned_eg_data, <span class="fu">aes</span>(<span class="at">x =</span> sst_anomaly, <span class="at">y =</span> prop_present)) <span class="sc">+</span></span>
<span id="cb133-3"><a href="#cb133-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(pred_grid_pa,</span>
<span id="cb133-4"><a href="#cb133-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> sst_centered_prev,</span>
<span id="cb133-5"><a href="#cb133-5" aria-hidden="true" tabindex="-1"></a>                          <span class="at">y =</span> predicted,</span>
<span id="cb133-6"><a href="#cb133-6" aria-hidden="true" tabindex="-1"></a>                          <span class="at">color =</span> average_mean_sst,</span>
<span id="cb133-7"><a href="#cb133-7" aria-hidden="true" tabindex="-1"></a>                          <span class="at">group =</span> average_mean_sst),</span>
<span id="cb133-8"><a href="#cb133-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb133-9"><a href="#cb133-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(pred_grid_pa,</span>
<span id="cb133-10"><a href="#cb133-10" aria-hidden="true" tabindex="-1"></a>              <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> sst_centered_prev, <span class="at">y =</span> predicted,</span>
<span id="cb133-11"><a href="#cb133-11" aria-hidden="true" tabindex="-1"></a>                            <span class="at">ymin =</span> lower, <span class="at">ymax =</span> upper,</span>
<span id="cb133-12"><a href="#cb133-12" aria-hidden="true" tabindex="-1"></a>                            <span class="at">group =</span> average_mean_sst),</span>
<span id="cb133-13"><a href="#cb133-13" aria-hidden="true" tabindex="-1"></a>              <span class="at">linetype =</span> <span class="dv">0</span>, <span class="at">alpha =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb133-14"><a href="#cb133-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb133-15"><a href="#cb133-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_gradient</span>(<span class="at">low =</span> <span class="st">"blue"</span>, <span class="at">high =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb133-16"><a href="#cb133-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb133-17"><a href="#cb133-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">label_percent</span>()) <span class="sc">+</span></span>
<span id="cb133-18"><a href="#cb133-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Modeled Probability of Presence Absence"</span>,</span>
<span id="cb133-19"><a href="#cb133-19" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"[grids represent bins of site-years with similar SST anomalies]"</span>,</span>
<span id="cb133-20"><a href="#cb133-20" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Modeled Probability (line) &amp; Actual Proportion (grids) of Presence"</span>,</span>
<span id="cb133-21"><a href="#cb133-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"SST Anomaly (°C)"</span>,</span>
<span id="cb133-22"><a href="#cb133-22" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Average Mean</span></span>
<span id="cb133-23"><a href="#cb133-23" aria-hidden="true" tabindex="-1"></a><span class="st">Summer SST (°C)"</span>,</span>
<span id="cb133-24"><a href="#cb133-24" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">"Ribbon = 95% CI"</span></span>
<span id="cb133-25"><a href="#cb133-25" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb133-26"><a href="#cb133-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.caption.position =</span> <span class="st">"plot"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="final_paper_files/figure-html/Visualize%20Presence%20Absence%20Model%20-%202-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:50%;">
<ol start="2" type="a">
<li></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot modeled probability of presence with proportion of sites with presence binned by sst anomaly</span></span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(binned_site_eg_data, <span class="fu">aes</span>(<span class="at">x =</span> sst_anomaly, <span class="at">y =</span> prop_present, <span class="at">color =</span> site)) <span class="sc">+</span></span>
<span id="cb134-3"><a href="#cb134-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb134-4"><a href="#cb134-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(pred_grid_pa_site,</span>
<span id="cb134-5"><a href="#cb134-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> sst_centered_prev, <span class="at">y =</span> predicted, <span class="at">color =</span> site)) <span class="sc">+</span></span>
<span id="cb134-6"><a href="#cb134-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(pred_grid_pa_site,</span>
<span id="cb134-7"><a href="#cb134-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> sst_centered_prev, <span class="at">y =</span> predicted,</span>
<span id="cb134-8"><a href="#cb134-8" aria-hidden="true" tabindex="-1"></a>                            <span class="at">ymin =</span> lower, <span class="at">ymax =</span> upper,</span>
<span id="cb134-9"><a href="#cb134-9" aria-hidden="true" tabindex="-1"></a>                            <span class="at">fill =</span> site),</span>
<span id="cb134-10"><a href="#cb134-10" aria-hidden="true" tabindex="-1"></a>              <span class="at">linetype =</span> <span class="dv">0</span>, <span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb134-11"><a href="#cb134-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">palette =</span> <span class="st">"Dark2"</span>) <span class="sc">+</span></span>
<span id="cb134-12"><a href="#cb134-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Dark2"</span>) <span class="sc">+</span></span>
<span id="cb134-13"><a href="#cb134-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>site) <span class="sc">+</span></span>
<span id="cb134-14"><a href="#cb134-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Modeled Probability (line) &amp; Actual Proportion (grids) of Presence"</span>,</span>
<span id="cb134-15"><a href="#cb134-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"SST Anomaly (°C)"</span>,</span>
<span id="cb134-16"><a href="#cb134-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">"Ribbon = 95% CI"</span>,</span>
<span id="cb134-17"><a href="#cb134-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Site"</span>,</span>
<span id="cb134-18"><a href="#cb134-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Site"</span></span>
<span id="cb134-19"><a href="#cb134-19" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb134-20"><a href="#cb134-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb134-21"><a href="#cb134-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">label_percent</span>()) <span class="sc">+</span></span>
<span id="cb134-22"><a href="#cb134-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.caption.position =</span> <span class="st">"plot"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="final_paper_files/figure-html/Visualize%20Presence%20Absence%20Model%20-%203-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
<p><em>Figure 6 - Results from the linear presence-absence model. a) Modeled probabilities of eelgrass presence predicted by Previous Summer SST Anomaly (PS-SSTA). Individual curves depict model predictions at distinct Average Mean Summer SSTs (AMS-SST) corresponding to those of each study site. Ribbons depict 95% confidence intervals, and grids represent actual proportions of presence within bins of site-years with similar SST ranges. b) Modeled probabilities of eelgrass presence predicted by PS-SSTA for each study site, with 95% confidence intervals. Grids represent actual proportions of presence within bins of site-years with similar SST ranges.</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom.mixed)</span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb135-3"><a href="#cb135-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb135-4"><a href="#cb135-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb135-5"><a href="#cb135-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-6"><a href="#cb135-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Output table of summary statistics</span></span>
<span id="cb135-7"><a href="#cb135-7" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(eelgrass_pa_glmm) <span class="sc">|&gt;</span> </span>
<span id="cb135-8"><a href="#cb135-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(estimate<span class="sc">:</span>p.value, <span class="sc">~</span><span class="fu">round</span>(., <span class="dv">3</span>))) <span class="sc">|&gt;</span></span>
<span id="cb135-9"><a href="#cb135-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>() <span class="sc">|&gt;</span> </span>
<span id="cb135-10"><a href="#cb135-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">font_size =</span> <span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table caption-top table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">effect</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">component</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">group</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">term</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">std.error</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">statistic</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">fixed</td>
<td style="text-align: left;">cond</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">8.107</td>
<td style="text-align: right;">7.408</td>
<td style="text-align: right;">1.094</td>
<td style="text-align: right;">0.274</td>
</tr>
<tr class="even">
<td style="text-align: left;">fixed</td>
<td style="text-align: left;">cond</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">sst_centered_prev</td>
<td style="text-align: right;">-0.797</td>
<td style="text-align: right;">0.481</td>
<td style="text-align: right;">-1.656</td>
<td style="text-align: right;">0.098</td>
</tr>
<tr class="odd">
<td style="text-align: left;">fixed</td>
<td style="text-align: left;">cond</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">average_mean_sst</td>
<td style="text-align: right;">-0.325</td>
<td style="text-align: right;">0.382</td>
<td style="text-align: right;">-0.851</td>
<td style="text-align: right;">0.395</td>
</tr>
<tr class="even">
<td style="text-align: left;">ran_pars</td>
<td style="text-align: left;">cond</td>
<td style="text-align: left;">site</td>
<td style="text-align: left;">sd__(Intercept)</td>
<td style="text-align: right;">2.118</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ran_pars</td>
<td style="text-align: left;">cond</td>
<td style="text-align: left;">site</td>
<td style="text-align: left;">sd__sst_centered_prev</td>
<td style="text-align: right;">0.933</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">ran_pars</td>
<td style="text-align: left;">cond</td>
<td style="text-align: left;">site</td>
<td style="text-align: left;">cor__(Intercept).sst_centered_prev</td>
<td style="text-align: right;">0.645</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ran_pars</td>
<td style="text-align: left;">cond</td>
<td style="text-align: left;">site:site_quadrat</td>
<td style="text-align: left;">sd__(Intercept)</td>
<td style="text-align: right;">0.414</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">ran_pars</td>
<td style="text-align: left;">cond</td>
<td style="text-align: left;">year</td>
<td style="text-align: left;">sd__(Intercept)</td>
<td style="text-align: right;">1.282</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
</tbody>
</table>


</div>
</div>
<p><em>Table 3 - Summary statistics for the linear presence-absence model.</em></p>
</section>
<section id="discussion" class="level3">
<h3 class="anchored" data-anchor-id="discussion">Discussion</h3>
<p>Neither of the linear models provided strong evidence to reject the null hypothesis that previous summer SST anomalies have no effect on eelgrass cover. The presence-absence model provided weak evidence (<span class="math inline">\(p = 0.098\)</span>) that the null can be rejected, however this is caveated by the model’s failure to meet the assumption of homoscedasticity, likely due to a false assumption of linearity, spatial and temporal autocorrelation, or both. Plaisted et al.&nbsp;2022 applied thin-plate regression splines to address non-linearity and found a correlation between previous summer water temperature anomalies and probability of presence, although did not find evidence for this same relationship with percent cover <span class="citation" data-cites="plaisted_influence_2022">(<a href="#ref-plaisted_influence_2022" role="doc-biblioref">Plaisted et al. 2022</a>)</span>.</p>
<p>The non-linear percent cover spline model provided stronger evidence to reject the null hypothesis, however only for the lower ranges of SST anomalies (<span class="math inline">\(p_1 = 0.024\)</span>, <span class="math inline">\(p_2 = 0.002\)</span>, <span class="math inline">\(p_3 = 0.343\)</span>). One way to interpret these results, in which percent cover values and presence are higher at SST anomalies below ~0.5°C, and subsequently more scattered above that temperature range, is that the -0.5°C anomaly represents a health threshold for eelgrass adapted to their local environment. While it may seem illogical for the threshold to be below 0, this could be explained by warming having already occurred prior to the study period. For example, the Gulf of Maine is known to have been warming for at least the last five decades <span class="citation" data-cites="seidov_recent_2021">(<a href="#ref-seidov_recent_2021" role="doc-biblioref">Seidov, Mishonov, and Parsons 2021</a>)</span>. The AMS-SST values in this study may already be above ideal conditions for northeastern eelgrass populations. Optimal temperatures for temperate eelgrass photosynthesis vary by population but have been estimated to be around 23°C <span class="citation" data-cites="lee_effects_2007">(<a href="#ref-lee_effects_2007" role="doc-biblioref">Lee, Park, and Kim 2007</a>)</span>, the upper range of the AMS-SST values measured in this study. This interpretation is further supported by the comparison between JPL satellite SST measurements and in-situ measurements used in the Plaisted et al.&nbsp;2022 analysis (Figure 2), which show the SST measurements in this analysis to be consistently 2-7°C cooler than in-situ measurements, except in the case of Salem Sound which is known to be a deeper eelgrass bed.</p>
<p>An alternative explanation of the stronger findings in the low temperature anomaly range and the overall negative slopes across all models is the dearth of data in the lowest temperature anomaly range. Within the monitoring data, a disproportionately smaller number of observations were recorded below a -1°C PS-SSTA (only 10 out of 109 transect-years), the majority of which came from the two Cape Cod sites and had distinctly high percent cover and proportions of presence. These observations may explain the overall negative slopes across all models, and is particularly emphasized in the spline model.</p>
<p>One counterintuitive observation is the opposing percent cover trends between the Fort Getty and T-Dock sites, given their proximity and shared location in Narragansett Bay. Across all sites, local conditions may explain the differing trends relative to SST anomalies, however given Fort Getty and T-Dock were the two most proximal sites, I did not expect differences to be so pronounced between these two locations. This finding suggests there may be more granular factors controlling eelgrass cover in Narragansett Bay, such as boating activity or sediment movement.</p>
</section>
<section id="conclusions" class="level3">
<h3 class="anchored" data-anchor-id="conclusions">Conclusions</h3>
<p>This analysis attempted to establish a causal connection between remotely sensed SST anomalies and changes to eelgrass cover along the northeastern U.S. coast by applying a Mundlak regression approach. While linear models predicting percent cover and probability of presence provided little to no evidence to reject the null hypothesis that previous summer SST anomalies have no effect on eelgrass cover, a non-linear spline model provided strong evidence to reject the null in the lower temperature anomaly range (&lt; -0.5°C), however these results are caveated by the fact that the majority of data in the lowest SST anomaly range came from a select few sites, and thus the findings may be inappropriate to apply to northeast eelgrass populations without further analysis.</p>
</section>
<section id="references" class="level3">
<h3 class="anchored" data-anchor-id="references">References</h3>
<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-correia_designing_2025" class="csl-entry" role="listitem">
Correia, Hannah E., Laura E. Dee, and Paul J. Ferraro. 2025. <span>“Designing Causal Mediation Analyses to Quantify Intermediary Processes in Ecology.”</span> <em>Biological Reviews</em>, March, brv.70011. <a href="https://doi.org/10.1111/brv.70011">https://doi.org/10.1111/brv.70011</a>.
</div>
<div id="ref-jabbari_modelling_2024" class="csl-entry" role="listitem">
Jabbari, Aidin, Yongsheng Wu, Melisa C. Wong, and Michael Dowd. 2024. <span>“Modelling Water Temperature Dynamics for Eelgrass (<span>Zostera</span> Marina) Areas in the Nearshore <span>Scotian</span> <span>Shelf</span>.”</span> <em>Frontiers in Marine Science</em> 11 (July). <a href="https://doi.org/10.3389/fmars.2024.1374884">https://doi.org/10.3389/fmars.2024.1374884</a>.
</div>
<div id="ref-larsen_causal_2019" class="csl-entry" role="listitem">
Larsen, Ashley E., Kyle Meng, and Bruce E. Kendall. 2019. <span>“Causal Analysis in Control–Impact Ecological Studies with Observational Data.”</span> Edited by Robert B. O’Hara. <em>Methods in Ecology and Evolution</em> 10 (7): 924–34. <a href="https://doi.org/10.1111/2041-210X.13190">https://doi.org/10.1111/2041-210X.13190</a>.
</div>
<div id="ref-lee_effects_2007" class="csl-entry" role="listitem">
Lee, Kun-Seop, Sang Rul Park, and Young Kyun Kim. 2007. <span>“Effects of Irradiance, Temperature, and Nutrients on Growth Dynamics of Seagrasses: <span>A</span> Review.”</span> <em>Journal of Experimental Marine Biology and Ecology</em> 350 (1-2): 144–75. <a href="https://doi.org/10.1016/j.jembe.2007.06.016">https://doi.org/10.1016/j.jembe.2007.06.016</a>.
</div>
<div id="ref-plaisted_influence_2022" class="csl-entry" role="listitem">
Plaisted, Holly K., Erin C. Shields, Alyssa B. Novak, Christopher P. Peck, Forest Schenck, Jillian Carr, Paul A. Duffy, et al. 2022. <span>“Influence of <span>Rising</span> <span>Water</span> <span>Temperature</span> on the <span>Temperate</span> <span>Seagrass</span> <span>Species</span> <span>Eelgrass</span> (<span>Zostera</span> Marina <span>L</span>.) in the <span>Northeast</span> <span>USA</span>.”</span> <em>Frontiers in Marine Science</em> 9 (July): 920699. <a href="https://doi.org/10.3389/fmars.2022.920699">https://doi.org/10.3389/fmars.2022.920699</a>.
</div>
<div id="ref-seidov_recent_2021" class="csl-entry" role="listitem">
Seidov, Dan, Alexey Mishonov, and Rost Parsons. 2021. <span>“Recent Warming and Decadal Variability of <span>Gulf</span> of <span>Maine</span> and <span>Slope</span> <span>Water</span>.”</span> <em>Limnology and Oceanography</em> 66 (9): 3472–88. <a href="https://doi.org/10.1002/lno.11892">https://doi.org/10.1002/lno.11892</a>.
</div>
<div id="ref-suskiewicz_ocean_2024" class="csl-entry" role="listitem">
Suskiewicz, Thew S., Jarrett E. K. Byrnes, Robert S. Steneck, Robert Russell, Carl J. Wilson, and Douglas B. Rasher. 2024. <span>“Ocean Warming Undermines the Recovery Resilience of <span>&lt;</span>Span Style="font-Variant:small-Caps;"<span>&gt;</span><span>N</span><span>&lt;</span>/Span<span>&gt;</span> Ew <span>&lt;</span>Span Style="font-Variant:small-Caps;"<span>&gt;</span><span>E</span><span>&lt;</span>/Span<span>&gt;</span> Ngland Kelp Forests Following a Fishery‐induced Trophic Cascade.”</span> <em>Ecology</em> 105 (7): e4334. <a href="https://doi.org/10.1002/ecy.4334">https://doi.org/10.1002/ecy.4334</a>.
</div>
</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>